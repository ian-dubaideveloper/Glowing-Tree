!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=48)}([function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)i(r,n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},a={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(n)},function(e,t,r){(function(){"use strict";if(!THREE)throw new Error("MeshLine requires three.js");function r(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new THREE.BufferGeometry,this.widthCallback=null}function n(e,t,r,n,i){var o;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,i&&t+i):e.slice(t,i&&t+i):e,r.set)r.set(e,n);else for(o=0;o<e.length;o++)r[o+n]=e[o];return r}function i(e){function t(e,t){return void 0===e?t:e}THREE.Material.call(this),e=e||{},this.lineWidth=t(e.lineWidth,1),this.map=t(e.map,null),this.useMap=t(e.useMap,0),this.alphaMap=t(e.alphaMap,null),this.useAlphaMap=t(e.useAlphaMap,0),this.color=t(e.color,new THREE.Color(16777215)),this.opacity=t(e.opacity,1),this.resolution=t(e.resolution,new THREE.Vector2(1,1)),this.sizeAttenuation=t(e.sizeAttenuation,1),this.near=t(e.near,1),this.far=t(e.far,1),this.dashArray=t(e.dashArray,0),this.dashOffset=t(e.dashOffset,0),this.dashRatio=t(e.dashRatio,.5),this.useDash=0!==this.dashArray?1:0,this.visibility=t(e.visibility,1),this.alphaTest=t(e.alphaTest,0),this.repeat=t(e.repeat,new THREE.Vector2(1,1));var r=new THREE.RawShaderMaterial({uniforms:{lineWidth:{type:"f",value:this.lineWidth},map:{type:"t",value:this.map},useMap:{type:"f",value:this.useMap},alphaMap:{type:"t",value:this.alphaMap},useAlphaMap:{type:"f",value:this.useAlphaMap},color:{type:"c",value:this.color},opacity:{type:"f",value:this.opacity},resolution:{type:"v2",value:this.resolution},sizeAttenuation:{type:"f",value:this.sizeAttenuation},near:{type:"f",value:this.near},far:{type:"f",value:this.far},dashArray:{type:"f",value:this.dashArray},dashOffset:{type:"f",value:this.dashOffset},dashRatio:{type:"f",value:this.dashRatio},useDash:{type:"f",value:this.useDash},visibility:{type:"f",value:this.visibility},alphaTest:{type:"f",value:this.alphaTest},repeat:{type:"v2",value:this.repeat}},vertexShader:["precision highp float;","","attribute vec3 position;","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute vec2 uv;","attribute float counters;","","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float near;","uniform float far;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","  vCounters = counters;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","  float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);","","    vColor = vec4( color, opacity );","    vUV = uv;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","  float pixelWidth = finalPosition.w * pixelWidthRatio;","    float w = 1.8 * pixelWidth * lineWidth * width;","","    if( sizeAttenuation == 1. ) {","        w = 1.8 * lineWidth * width;","    }","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec2 normal = vec2( -dir.y, dir.x );","    normal.x /= aspect;","    normal *= .5 * w;","","    vec4 offset = vec4( normal * side, 0.0, 1.0 );","    finalPosition.xy += offset.xy;","","    gl_Position = finalPosition;","","}"].join("\r\n"),fragmentShader:["#extension GL_OES_standard_derivatives : enable","precision mediump float;","","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","void main() {","","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));","    }","    gl_FragColor = c;","    gl_FragColor.a *= step(vCounters, visibility);","}"].join("\r\n")});return delete e.lineWidth,delete e.map,delete e.useMap,delete e.alphaMap,delete e.useAlphaMap,delete e.color,delete e.opacity,delete e.resolution,delete e.sizeAttenuation,delete e.near,delete e.far,delete e.dashArray,delete e.dashOffset,delete e.dashRatio,delete e.visibility,delete e.alphaTest,delete e.repeat,r.type="MeshLineMaterial",r.setValues(e),r}r.prototype.setGeometry=function(e,t){if(this.widthCallback=t,this.positions=[],this.counters=[],e instanceof THREE.Geometry)for(var r=0;r<e.vertices.length;r++){var n=e.vertices[r];t=r/e.vertices.length;this.positions.push(n.x,n.y,n.z),this.positions.push(n.x,n.y,n.z),this.counters.push(t),this.counters.push(t)}if(THREE.BufferGeometry,e instanceof Float32Array||e instanceof Array)for(r=0;r<e.length;r+=3){t=r/e.length;this.positions.push(e[r],e[r+1],e[r+2]),this.positions.push(e[r],e[r+1],e[r+2]),this.counters.push(t),this.counters.push(t)}this.process()},r.prototype.compareV3=function(e,t){var r=6*e,n=6*t;return this.positions[r]===this.positions[n]&&this.positions[r+1]===this.positions[n+1]&&this.positions[r+2]===this.positions[n+2]},r.prototype.copyV3=function(e){var t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]},r.prototype.process=function(){var e,t,r=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var n=0;n<r;n++)this.side.push(1),this.side.push(-1);for(n=0;n<r;n++)e=this.widthCallback?this.widthCallback(n/(r-1)):1,this.width.push(e),this.width.push(e);for(n=0;n<r;n++)this.uvs.push(n/(r-1),0),this.uvs.push(n/(r-1),1);t=this.compareV3(0,r-1)?this.copyV3(r-2):this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(n=0;n<r-1;n++)t=this.copyV3(n),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(n=1;n<r;n++)t=this.copyV3(n),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]);t=this.compareV3(r-1,0)?this.copyV3(1):this.copyV3(r-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]);for(n=0;n<r-1;n++){var i=2*n;this.indices_array.push(i,i+1,i+2),this.indices_array.push(i+2,i+1,i+3)}this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new THREE.BufferAttribute(new Float32Array(this.positions),3),previous:new THREE.BufferAttribute(new Float32Array(this.previous),3),next:new THREE.BufferAttribute(new Float32Array(this.next),3),side:new THREE.BufferAttribute(new Float32Array(this.side),1),width:new THREE.BufferAttribute(new Float32Array(this.width),1),uv:new THREE.BufferAttribute(new Float32Array(this.uvs),2),index:new THREE.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new THREE.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},r.prototype.advance=function(e){var t=this.attributes.position.array,r=this.attributes.previous.array,i=this.attributes.next.array,o=t.length;n(t,0,r,0,o),n(t,6,t,0,o-6),t[o-6]=e.x,t[o-5]=e.y,t[o-4]=e.z,t[o-3]=e.x,t[o-2]=e.y,t[o-1]=e.z,n(t,6,i,0,o-6),i[o-6]=e.x,i[o-5]=e.y,i[o-4]=e.z,i[o-3]=e.x,i[o-2]=e.y,i[o-1]=e.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},i.prototype=Object.create(THREE.Material.prototype),i.prototype.constructor=i,i.prototype.copy=function(e){return THREE.Material.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.near=e.near,this.far=e.far,this.dashArray.copy(e.dashArray),this.dashOffset.copy(e.dashOffset),this.dashRatio.copy(e.dashRatio),this.useDash=e.useDash,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this},e.exports&&(t=e.exports={MeshLine:r,MeshLineMaterial:i}),t.MeshLine=r,t.MeshLineMaterial=i}).call(this)},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){var n=r(20),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},function(e,t,r){var n=r(4).Symbol;e.exports=n},function(e,t,r){"use strict";e.exports=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,r,i){var o=n,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},function(e,t,r){"use strict";var n=r(0),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,i,o,s=t||e.length,u=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)u[n++]=i;else if((o=a[i])>4)u[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&e[r++],o--;o>1?u[n++]=65533:i<65536?u[n++]=i:(i-=65536,u[n++]=55296|i>>10&1023,u[n++]=56320|1023&i)}return l(u,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},function(e,t,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){var n=r(18),i=r(2);e.exports=function(e,t,r){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(r)&&(o="leading"in r?!!r.leading:o,a="trailing"in r?!!r.trailing:a),n(e,t,{leading:o,maxWait:t,trailing:a})}},function(e,t,r){e.exports=function(){"use strict";var e=function(){var t=0,r=document.createElement("div");function n(e){return r.appendChild(e.dom),e}function i(e){for(var n=0;n<r.children.length;n++)r.children[n].style.display=n===e?"block":"none";t=e}r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(e){e.preventDefault(),i(++t%r.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,l=n(new e.Panel("FPS","#0ff","#002")),u=n(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=n(new e.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:r,addPanel:n,showPanel:i,begin:function(){o=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(u.update(e-o,200),a+1e3<=e&&(l.update(1e3*s/(e-a),100),a=e,s=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:r,setMode:i}};return e.Panel=function(e,t,r){var n=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,u=3*a,c=2*a,h=3*a,d=15*a,p=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=l,m.style.cssText="width:80px;height:48px";var v=m.getContext("2d");return v.font="bold "+9*a+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=r,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,u,c),v.fillRect(h,d,p,f),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h,d,p,f),{dom:m,update:function(l,g){n=Math.min(n,l),i=Math.max(i,l),v.fillStyle=r,v.globalAlpha=1,v.fillRect(0,0,s,d),v.fillStyle=t,v.fillText(o(l)+" "+e+" ("+o(n)+"-"+o(i)+")",u,c),v.drawImage(m,h+a,d,p-a,f,h,d,p-a,f),v.fillRect(h+p-a,d,a,f),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h+p-a,d,a,o((1-l/g)*f))}}},e}()},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(36);var i=r(38),o=window.THREE;e.exports=function(){function e(e){var t,r=e.properties.Content,n=e.properties.RelativeFilename||e.properties.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var o=new Uint8Array(r);return window.URL.createObjectURL(new Blob([o],{type:t}))}function t(e,t,r,n){var i=function(e,t,r,n){var i,o=e.properties.FileName,a=e.properties.RelativeFilename,s=n.get(e.id).children;if(void 0!==s&&s.length>0&&r.has(s[0].ID))i=r.get(s[0].ID);else if(void 0!==a&&"/"!==a[0]&&null===a.match(/^[a-zA-Z]:/))i=a;else{var l=o.split(/[\\\/]/);i=l.length>0?l[l.length-1]:o}var u=t.path;0!==i.indexOf("blob:")&&0!==i.indexOf("data:")||t.setPath(void 0);var c=t.load(i);return t.setPath(u),c}(e,t,r,n);i.ID=e.id,i.name=e.attrName;var a=e.properties.WrapModeU,s=e.properties.WrapModeV,l=void 0!==a?a.value:0,u=void 0!==s?s.value:0;if(i.wrapS=0===l?o.RepeatWrapping:o.ClampToEdgeWrapping,i.wrapT=0===u?o.RepeatWrapping:o.ClampToEdgeWrapping,"Scaling"in e.properties){var c=e.properties.Scaling.value;i.repeat.x=c[0],i.repeat.y=c[1]}return i}function r(e,t,r,i){var s=t.id,l=t.attrName,u=t.properties.ShadingModel;if("object"===n(u)&&(u=u.value),!i.has(s))return null;var c,h=function(e,t,r,n,i){var s={};t.BumpFactor&&(s.bumpScale=t.BumpFactor.value);t.Diffuse&&(s.color=M(t.Diffuse));t.DisplacementFactor&&(s.displacementScale=t.DisplacementFactor.value);t.ReflectionFactor&&(s.reflectivity=t.ReflectionFactor.value);t.Specular&&(s.specular=M(t.Specular));t.Shininess&&(s.shininess=t.Shininess.value);t.Emissive&&(s.emissive=M(t.Emissive));t.EmissiveFactor&&(s.emissiveIntensity=parseFloat(t.EmissiveFactor.value));t.Opacity&&(s.opacity=parseFloat(t.Opacity.value));s.opacity<1&&(s.transparent=!0);return i.get(n).children.forEach((function(t){var n=t.relationship;switch(n){case"Bump":s.bumpMap=r.get(t.ID);break;case"DiffuseColor":s.map=a(e,r,t.ID,i);break;case"DisplacementColor":s.displacementMap=a(e,r,t.ID,i);break;case"EmissiveColor":s.emissiveMap=a(e,r,t.ID,i);break;case"NormalMap":s.normalMap=a(e,r,t.ID,i);break;case"ReflectionColor":s.envMap=a(e,r,t.ID,i),s.envMap.mapping=o.EquirectangularReflectionMapping;break;case"SpecularColor":s.specularMap=a(e,r,t.ID,i);break;case"TransparentColor":s.alphaMap=a(e,r,t.ID,i),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),s}(e,t.properties,r,s,i);switch(u.toLowerCase()){case"phong":c=new o.MeshPhongMaterial;break;case"lambert":c=new o.MeshLambertMaterial;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',u),c=new o.MeshPhongMaterial({color:3342591})}return c.setValues(h),c.name=l,c}function a(e,t,r,n){return"LayeredTexture"in e.Objects.subNodes&&r in e.Objects.subNodes.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),r=n.get(r).children[0].ID),t.get(r)}function s(e,t){var r=[];return e.children.forEach((function(e){var n=t[e.ID];if("Cluster"===n.attrType){var i={ID:e.ID,indices:[],weights:[],transform:(new o.Matrix4).fromArray(n.subNodes.Transform.properties.a),transformLink:(new o.Matrix4).fromArray(n.subNodes.TransformLink.properties.a)};"Indexes"in n.subNodes&&(i.indices=n.subNodes.Indexes.properties.a,i.weights=n.subNodes.Weights.properties.a),r.push(i)}})),{rawBones:r,bones:[]}}function l(e,t,r,n){switch(r.attrType){case"Mesh":return function(e,t,r,n){var i=t.parents.map((function(t){return e.Objects.subNodes.Model[t.ID]}));if(0===i.length)return;var a=t.children.reduce((function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e}),null),s=new o.Matrix4,l=i[0];if("GeometricRotation"in l.properties){var c=l.properties.GeometricRotation.value.map(o.Math.degToRad);c[3]="ZYX",s.makeRotationFromEuler((new o.Euler).fromArray(c))}"GeometricTranslation"in l.properties&&s.setPosition((new o.Vector3).fromArray(l.properties.GeometricTranslation.value));return function(e,t,r,n,i){var a=r.subNodes,s=a.Vertices.properties.a,l=a.PolygonVertexIndex.properties.a,c=[],h=[],p=[],f=[],m=[],v=[],g=[];if(a.LayerElementColor)var _=function(e){var t=e.properties.MappingInformationType,r=e.properties.ReferenceInformationType,n=e.subNodes.Colors.properties.a,i=[];"IndexToDirect"===r&&(i=e.subNodes.ColorIndex.properties.a);return{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}}(a.LayerElementColor[0]);if(a.LayerElementMaterial)var b=function(e){var t=e.properties.MappingInformationType,r=e.properties.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.subNodes.Materials.properties.a,i=[],o=0;o<n.length;++o)i.push(o);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}}(a.LayerElementMaterial[0]);if(a.LayerElementNormal)var y=function(e){var t=e.properties.MappingInformationType,r=e.properties.ReferenceInformationType,n=e.subNodes.Normals.properties.a,i=[];"IndexToDirect"===r&&("NormalIndex"in e.subNodes?i=e.subNodes.NormalIndex.properties.a:"NormalsIndex"in e.subNodes&&(i=e.subNodes.NormalsIndex.properties.a));return{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}}(a.LayerElementNormal[0]);if(a.LayerElementUV)for(var w=[],E=0;a.LayerElementUV[E];)w.push(u(a.LayerElementUV[E])),E++;var T={};null!==n&&n.rawBones.forEach((function(e,t){e.indices.forEach((function(r,n){void 0===T[r]&&(T[r]=[]),T[r].push({id:t,weight:e.weights[n]})}))}));var x=0,R=0,S=!1,A=[],k=[],C=[],M=[],L=[],O=[];l.forEach((function(e,t){var r=!1;e<0&&(e^=-1,l[t]=e,r=!0);var i=[],o=[];if(A.push(3*e,3*e+1,3*e+2),_){var a=d(t,x,e,_);C.push(a[0],a[1],a[2])}if(n){if(void 0!==T[e]&&T[e].forEach((function(e){o.push(e.weight),i.push(e.id)})),o.length>4){S||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),S=!0);var u=[0,0,0,0],E=[0,0,0,0];o.forEach((function(e,t){var r=e,n=i[t];E.forEach((function(e,t,i){if(r>e){i[t]=r,r=e;var o=u[t];u[t]=n,n=o}}))})),i=u,o=E}for(;o.length<4;)o.push(0),i.push(0);for(var P=0;P<4;++P)L.push(o[P]),O.push(i[P])}if(y){a=d(t,x,e,y);k.push(a[0],a[1],a[2])}if(b&&"AllSame"!==b.mappingType)var H=d(t,x,e,b)[0];if(w&&w.forEach((function(r,n){var i=d(t,x,e,r);void 0===M[n]&&(M[n]=[]),M[n].push(i[0]),M[n].push(i[1])})),R++,r){for(P=2;P<R;P++)c.push(s[A[0]]),c.push(s[A[1]]),c.push(s[A[2]]),c.push(s[A[3*(P-1)]]),c.push(s[A[3*(P-1)+1]]),c.push(s[A[3*(P-1)+2]]),c.push(s[A[3*P]]),c.push(s[A[3*P+1]]),c.push(s[A[3*P+2]]),n&&(v.push(L[0]),v.push(L[1]),v.push(L[2]),v.push(L[3]),v.push(L[4*(P-1)]),v.push(L[4*(P-1)+1]),v.push(L[4*(P-1)+2]),v.push(L[4*(P-1)+3]),v.push(L[4*P]),v.push(L[4*P+1]),v.push(L[4*P+2]),v.push(L[4*P+3]),g.push(O[0]),g.push(O[1]),g.push(O[2]),g.push(O[3]),g.push(O[4*(P-1)]),g.push(O[4*(P-1)+1]),g.push(O[4*(P-1)+2]),g.push(O[4*(P-1)+3]),g.push(O[4*P]),g.push(O[4*P+1]),g.push(O[4*P+2]),g.push(O[4*P+3])),_&&(p.push(C[0]),p.push(C[1]),p.push(C[2]),p.push(C[3*(P-1)]),p.push(C[3*(P-1)+1]),p.push(C[3*(P-1)+2]),p.push(C[3*P]),p.push(C[3*P+1]),p.push(C[3*P+2])),b&&"AllSame"!==b.mappingType&&(m.push(H),m.push(H),m.push(H)),y&&(h.push(k[0]),h.push(k[1]),h.push(k[2]),h.push(k[3*(P-1)]),h.push(k[3*(P-1)+1]),h.push(k[3*(P-1)+2]),h.push(k[3*P]),h.push(k[3*P+1]),h.push(k[3*P+2])),w&&w.forEach((function(e,t){void 0===f[t]&&(f[t]=[]),f[t].push(M[t][0]),f[t].push(M[t][1]),f[t].push(M[t][2*(P-1)]),f[t].push(M[t][2*(P-1)+1]),f[t].push(M[t][2*P]),f[t].push(M[t][2*P+1])}));x++,r=!1,R=0,A=[],k=[],C=[],M=[],L=[],O=[]}}));var P=new o.BufferGeometry;P.name=r.name;var H=new o.Float32BufferAttribute(c,3);i.applyToBufferAttribute(H),P.setAttribute("position",H),p.length>0&&P.setAttribute("color",new o.Float32BufferAttribute(p,3));n&&(P.setAttribute("skinIndex",new o.Float32BufferAttribute(g,4)),P.setAttribute("skinWeight",new o.Float32BufferAttribute(v,4)),P.FBX_Deformer=n);h.length>0&&P.setAttribute("normal",new o.Float32BufferAttribute(h,3));if(f.forEach((function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),P.setAttribute(r,new o.Float32BufferAttribute(f[t],2))})),b&&"AllSame"!==b.mappingType){var D=m[0],I=0;if(m.forEach((function(e,t){e!==D&&(P.addGroup(I,t-I,D),D=e,I=t)})),P.groups.length>0){var B=P.groups[P.groups.length-1],N=B.start+B.count;N!==m.length&&P.addGroup(N,m.length-N,D)}0===P.groups.length&&P.addGroup(0,m.length,m[0])}return P}(0,0,r,a,s)}(e,t,r,n);case"NurbsCurve":return function(e){if(void 0===o.NURBSCurve)return console.error("FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new o.BufferGeometry;var t=parseInt(e.properties.Order);if(isNaN(t))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",e.properties.Order,e.id),new o.BufferGeometry;for(var r,n,i=t-1,a=e.subNodes.KnotVector.properties.a,s=[],l=e.subNodes.Points.properties.a,u=0,c=l.length;u<c;u+=4)s.push((new o.Vector4).fromArray(l,u));if("Closed"===e.properties.Form)s.push(s[0]);else if("Periodic"===e.properties.Form){r=i,n=a.length-1-r;for(u=0;u<i;++u)s.push(s[u])}var h=new o.NURBSCurve(i,a,s,r,n).getPoints(7*s.length),d=new Float32Array(3*h.length);h.forEach((function(e,t){e.toArray(d,3*t)}));var p=new o.BufferGeometry;return p.setAttribute("position",new o.BufferAttribute(d,3)),p}(r)}}function u(e){var t=e.properties.MappingInformationType,r=e.properties.ReferenceInformationType,n=e.subNodes.UV.properties.a,i=[];return"IndexToDirect"===r&&(i=e.subNodes.UVIndex.properties.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}}FBXLoader=function(e){this.manager=void 0!==e?e:o.DefaultLoadingManager},Object.assign(FBXLoader.prototype,{load:function(e,t,r,n){var i=this,a=o.LoaderUtils.extractUrlBase(e),s=new o.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,(function(r){try{var o=i.parse(r,a);t(o)}catch(t){setTimeout((function(){n&&n(t),i.manager.itemError(e)}),0)}}),r,n)},parse:function(n,i){var a,u,c;if(c="Kaydara FBX Binary  \0",(u=n).byteLength>=c.length&&c===L(u,0,c.length))a=(new x).parse(n);else{var h=L(n);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;for(var n=0;n<t.length;++n){if((o=void 0,o=e[(i=1)-1],e=e.slice(r+i),r++,o)===t[n])return!1}var i,o;return!0}(h))throw new Error("FBXLoader: Unknown format.");if(A(h)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+A(h));a=(new T).parse(h)}var d=function(e){var t=new Map;if("Connections"in e){e.Connections.properties.connections.forEach((function(e){var r=e[0],n=e[1],i=e[2];t.has(r)||t.set(r,{parents:[],children:[]});var o={ID:n,relationship:i};t.get(r).parents.push(o),t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:r,relationship:i};t.get(n).children.push(a)}))}return t}(a),y=function(t){var r=new Map,n={},i=[];if("Video"in t.Objects.subNodes){var o=t.Objects.subNodes.Video;for(var a in o){var s=o[a],l=parseInt(a);if(s.properties.fileName in n&&i.push([l,n[s.properties.fileName]]),n[s.properties.fileName]=l,"Content"in s.properties&&""!==s.properties.Content){var u=e(o[a]);r.set(l,u)}}}return i.forEach((function(e){if(r.has(e[0])&&!r.has(e[1])){var t=r.get(e[0]);r.set(e[1],t)}else if(r.has(e[1])&&!r.has(e[0])){t=r.get(e[1]);r.set(e[0],t)}})),r}(a),w=function(e,t,n){var i=new Map;if("Material"in e.Objects.subNodes){var o=e.Objects.subNodes.Material;for(var a in o){var s=r(e,o[a],t,n);null!==s&&i.set(parseInt(a),s)}}return i}(a,function(e,r,n,i){var o=new Map;if("Texture"in e.Objects.subNodes){var a=e.Objects.subNodes.Texture;for(var s in a){var l=t(a[s],r,n,i);o.set(parseInt(s),l)}}return o}(a,new o.TextureLoader(this.manager).setPath(i),y,d),d),E=function(e,t){var r={};if("Deformer"in e.Objects.subNodes){var n=e.Objects.subNodes.Deformer;for(var i in n){if("Skin"===n[i].attrType){var o=t.get(parseInt(i)),a=s(o,n);a.ID=i,o.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,r[i]=a}}}return r}(a,d),R=function(e,t,r){var n=new Map;if("Geometry"in e.Objects.subNodes){var i=e.Objects.subNodes.Geometry;for(var o in i){var a=t.get(parseInt(o)),s=l(e,a,i[o],r);n.set(parseInt(o),s)}}return n}(a,d,E);return function(e,t,r,n,i){var a=new o.Group,s=function(e,t,r,n,i){var a=new Map,s=e.Objects.subNodes.Model;for(var l in s){var u=parseInt(l),c=s[l],h=i.get(u),d=p(h,t,u,c.attrName);if(!d){switch(c.attrType){case"Camera":d=f(e,h);break;case"Light":d=m(e,h);break;case"Mesh":d=v(e,h,r,n);break;case"NurbsCurve":d=g(h,r);break;case"LimbNode":case"Null":default:d=new o.Group}d.name=o.PropertyBinding.sanitizeNodeName(c.attrName),d.ID=u}_(e,d,c),a.set(u,d)}return a}(e,r,n,i,t),l=e.Objects.subNodes.Model;return s.forEach((function(r){var n=l[r.ID];!function(e,t,r,n,i){if("LookAtProperty"in r.properties){n.get(t.ID).children.forEach((function(r){if("LookAtProperty"===r.relationship){var n=e.Objects.subNodes.Model[r.ID];if("Lcl_Translation"in n.properties){var a=n.properties.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(a),i.add(t.target)):t.lookAt((new o.Vector3).fromArray(a))}}}))}}(e,r,n,t,a),t.get(r.ID).parents.forEach((function(e){var t=s.get(e.ID);void 0!==t&&t.add(r)})),null===r.parent&&a.add(r)})),function(e,t,r,n,i,a){a.updateMatrixWorld(!0);var s=new Map;if("Pose"in e.Objects.subNodes){var l=e.Objects.subNodes.Pose;for(var u in l)if("BindPose"===l[u].attrType){var c=l[u].subNodes.PoseNode;if(Array.isArray(c))c.forEach((function(e){var t=(new o.Matrix4).fromArray(e.subNodes.Matrix.properties.a);s.set(parseInt(e.properties.Node),t)}));else{var h=(new o.Matrix4).fromArray(c.subNodes.Matrix.properties.a);s.set(parseInt(c.properties.Node),h)}}}for(var d in t){var p=t[d];p.bones.forEach((function(e,t){if(s.has(e.ID)){var r=s.get(e.ID);e.matrixWorld.copy(r)}else e.matrixWorld.copy(p.rawBones[t].transformLink)})),i.get(parseInt(p.ID)).parents.forEach((function(e){if(r.has(e.ID)){var t=e.ID;i.get(t).parents.forEach((function(e){if(n.has(e.ID)){var t=n.get(e.ID);t.bind(new o.Skeleton(p.bones),t.matrixWorld)}}))}}))}a.updateMatrixWorld(!0)}(e,r,n,s,t,a),function(e,t,r){r.animations=[];var n=function(e,t){if(void 0===e.Objects.subNodes.AnimationCurve)return;var r=function(e){var t=e.Objects.subNodes.AnimationCurveNode,r=new Map;for(var n in t){var i=t[n];if(null!==i.attrName.match(/S|R|T/))var o={id:i.id,attr:i.attrName,curves:{}};r.set(o.id,o)}return r}(e);!function(e,t,r){var n=e.Objects.subNodes.AnimationCurve;for(var i in n){var o={id:n[i].id,times:n[i].subNodes.KeyTime.properties.a.map(k),values:n[i].subNodes.KeyValueFloat.properties.a},a=t.get(o.id);if(void 0!==a){var s=a.parents[0].ID,l=a.parents[0].relationship,u="";if(l.match(/X/))u="x";else if(l.match(/Y/))u="y";else{if(!l.match(/Z/))continue;u="z"}r.get(s).curves[u]=o}}}(e,t,r);var n=function(e,t,r){var n=e.Objects.subNodes.AnimationLayer,i=new Map;for(var a in n){var s=[],l=t.get(parseInt(a));if(void 0!==l)l.children.forEach((function(n,i){if(r.has(n.ID)){var a=r.get(n.ID);if(void 0===s[i]){var l;t.get(n.ID).parents.forEach((function(e){void 0!==e.relationship&&(l=e.ID)}));var u=e.Objects.subNodes.Model[l.toString()],c={modelName:o.PropertyBinding.sanitizeNodeName(u.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in u.properties&&(c.initialPosition=u.properties.Lcl_Translation.value),"Lcl_Rotation"in u.properties&&(c.initialRotation=u.properties.Lcl_Rotation.value),"Lcl_Scaling"in u.properties&&(c.initialScale=u.properties.Lcl_Scaling.value),"PreRotation"in u.properties&&(c.preRotations=u.properties.PreRotation.value),s[i]=c}s[i][a.attr]=a}})),i.set(parseInt(a),s)}return i}(e,t,r);return function(e,t,r){var n=e.Objects.subNodes.AnimationStack,i={};for(var o in n){var a=t.get(parseInt(o)).children;a.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=r.get(a[0].ID);i[o]={name:n[o].attrName,layer:s}}return i}(e,t,n)}(e,t);if(void 0===n)return;for(var i in n){var a=b(n[i]);r.animations.push(a)}}(e,t,a),function(e,t){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings.properties){var r=e.GlobalSettings.properties.AmbientColor.value,n=r[0],i=r[1],a=r[2];if(0!==n||0!==i||0!==a){var s=new o.Color(n,i,a);t.add(new o.AmbientLight(s,1))}}}(e,a),a}(a,d,E,R,w)}});var c=[],h={ByPolygonVertex:{Direct:function(e,t,r,n){var i=e*n.dataSize,o=e*n.dataSize+n.dataSize;return O(c,n.buffer,i,o)},IndexToDirect:function(e,t,r,n){var i=n.indices[e],o=i*n.dataSize,a=i*n.dataSize+n.dataSize;return O(c,n.buffer,o,a)}},ByPolygon:{Direct:function(e,t,r,n){var i=t*n.dataSize,o=t*n.dataSize+n.dataSize;return O(c,n.buffer,i,o)},IndexToDirect:function(e,t,r,n){var i=n.indices[t],o=i*n.dataSize,a=i*n.dataSize+n.dataSize;return O(c,n.buffer,o,a)}},ByVertice:{Direct:function(e,t,r,n){var i=r*n.dataSize,o=r*n.dataSize+n.dataSize;return O(c,n.buffer,i,o)}},AllSame:{IndexToDirect:function(e,t,r,n){var i=n.indices[0]*n.dataSize,o=n.indices[0]*n.dataSize+n.dataSize;return O(c,n.buffer,i,o)}}};function d(e,t,r,n){return h[n.mappingType][n.referenceType](e,t,r,n)}function p(e,t,r,n){var i=null;return e.parents.forEach((function(e){for(var a in t){var s=t[a];s.rawBones.forEach((function(t,a){if(t.ID===e.ID){var l=i;(i=new o.Bone).name=o.PropertyBinding.sanitizeNodeName(n),i.ID=r,s.bones[a]=i,null!==l&&i.add(l)}}))}})),i}function f(e,t){var r,n;if(t.children.forEach((function(t){var r=e.Objects.subNodes.NodeAttribute[t.ID];void 0!==r&&void 0!==r.properties&&(n=r.properties)})),void 0===n)r=new o.Object3D;else{var i=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(i=1);var a=1;void 0!==n.NearPlane&&(a=n.NearPlane.value/1e3);var s=1e3;void 0!==n.FarPlane&&(s=n.FarPlane.value/1e3);var l=window.innerWidth,u=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(l=n.AspectWidth.value,u=n.AspectHeight.value);var c=l/u,h=45;switch(void 0!==n.FieldOfView&&(h=n.FieldOfView.value),i){case 0:r=new o.PerspectiveCamera(h,c,a,s);break;case 1:r=new o.OrthographicCamera(-l/2,l/2,u/2,-u/2,a,s);break;default:console.warn("FBXLoader: Unknown camera type "+i+"."),r=new o.Object3D}}return r}function m(e,t){var r,n;if(t.children.forEach((function(t){var r=e.Objects.subNodes.NodeAttribute[t.ID];void 0!==r&&void 0!==r.properties&&(n=r.properties)})),void 0===n)r=new o.Object3D;else{var i;i=void 0===n.LightType?0:n.LightType.value;var a=16777215;void 0!==n.Color&&(a=M(n.Color));var s=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(s=0);var l=0;void 0!==n.FarAttenuationEnd&&(l=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value/1e3);switch(i){case 0:r=new o.PointLight(a,s,l,1);break;case 1:r=new o.DirectionalLight(a,s);break;case 2:var u=Math.PI/3;void 0!==n.InnerAngle&&(u=o.Math.degToRad(n.InnerAngle.value));var c=0;void 0!==n.OuterAngle&&(c=o.Math.degToRad(n.OuterAngle.value),c=Math.max(c,1)),r=new o.SpotLight(a,s,l,u,c,1);break;default:console.warn("FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a THREE.PointLight."),r=new o.PointLight(a,s)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(r.castShadow=!0)}return r}function v(e,t,r,n){var i,a=null,s=null,l=[];return t.children.forEach((function(e){r.has(e.ID)&&(a=r.get(e.ID)),n.has(e.ID)&&l.push(n.get(e.ID))})),l.length>1?s=l:l.length>0?s=l[0]:(s=new o.MeshPhongMaterial({color:13421772}),l.push(s)),"color"in a.attributes&&l.forEach((function(e){e.vertexColors=o.VertexColors})),a.FBX_Deformer?(l.forEach((function(e){e.skinning=!0})),i=new o.SkinnedMesh(a,s)):i=new o.Mesh(a,s),i}function g(e,t){var r=e.children.reduce((function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e}),null),n=new o.LineBasicMaterial({color:3342591,linewidth:1});return new o.Line(r,n)}function _(e,t,r){if("RotationOrder"in r.properties){var n=parseInt(r.properties.RotationOrder.value,10);n>0&&n<6?console.warn("FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"][n]):6===n&&console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}if("Lcl_Translation"in r.properties&&t.position.fromArray(r.properties.Lcl_Translation.value),"Lcl_Rotation"in r.properties){var i=r.properties.Lcl_Rotation.value.map(o.Math.degToRad);i.push("ZYX"),t.rotation.fromArray(i)}if("Lcl_Scaling"in r.properties&&t.scale.fromArray(r.properties.Lcl_Scaling.value),"PreRotation"in r.properties){var a=r.properties.PreRotation.value.map(o.Math.degToRad);a[3]="ZYX";var s=(new o.Euler).fromArray(a);s=(new o.Quaternion).setFromEuler(s);var l=(new o.Quaternion).setFromEuler(t.rotation);s.multiply(l),t.rotation.setFromQuaternion(s,"ZYX")}}function b(e){var t=[];return e.layer.forEach((function(e){t=t.concat(function(e){var t=[];if(void 0!==e.T){var r=y(e.modelName,e.T.curves,e.initialPosition,"position");void 0!==r&&t.push(r)}if(void 0!==e.R){var n=function(e,t,r,n){void 0!==t.x&&(t.x.values=t.x.values.map(o.Math.degToRad));void 0!==t.y&&(t.y.values=t.y.values.map(o.Math.degToRad));void 0!==t.z&&(t.z.values=t.z.values.map(o.Math.degToRad));var i=E(t),a=w(i,t,r);void 0!==n&&((n=n.map(o.Math.degToRad)).push("ZYX"),n=(new o.Euler).fromArray(n),n=(new o.Quaternion).setFromEuler(n));for(var s=new o.Quaternion,l=new o.Euler,u=[],c=0;c<a.length;c+=3)l.set(a[c],a[c+1],a[c+2],"ZYX"),s.setFromEuler(l),void 0!==n&&s.premultiply(n),s.toArray(u,c/3*4);return new o.QuaternionKeyframeTrack(e+".quaternion",i,u)}(e.modelName,e.R.curves,e.initialRotation,e.preRotations);void 0!==n&&t.push(n)}if(void 0!==e.S){var i=y(e.modelName,e.S.curves,e.initialScale,"scale");void 0!==i&&t.push(i)}return t}(e))})),new o.AnimationClip(e.name,-1,t)}function y(e,t,r,n){var i=E(t),a=w(i,t,r);return new o.VectorKeyframeTrack(e+"."+n,i,a)}function w(e,t,r){var n=r,i=[],o=-1,a=-1,s=-1;return e.forEach((function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==o){var r=t.x.values[o];i.push(r),n[0]=r}else i.push(n[0]);if(-1!==a){var l=t.y.values[a];i.push(l),n[1]=l}else i.push(n[1]);if(-1!==s){var u=t.z.values[s];i.push(u),n[2]=u}else i.push(n[2])})),i}function E(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})).filter((function(e,t,r){return r.indexOf(e)==t}))}function T(){}function x(){}function R(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function S(){}function A(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("FBXLoader: Cannot find the version number for the file given.")}function k(e){return e/46186158e3}function C(e){return e.split(",").map((function(e){return parseFloat(e)}))}function M(e){var t=new o.Color;return"Color"===e.type?t.setScalar(e.value):t.fromArray(e.value)}function L(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),o.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function O(e,t,r,n){for(var i=r,o=0;i<n;i++,o++)e[o]=t[i];return e}return Object.assign(T.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new S,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split("\n");return r.forEach((function(e,n){var i=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(!i&&!o){var a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,r[++n]):l?t.nodeEnd():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:r,properties:{},subNodes:{}},o=this.parseNodeAttr(n),a=this.getCurrentNode();if(0===this.currentIndent)this.allNodes.add(r,i);else if(r in a.subNodes){var s=a.subNodes[r];this.isFlattenNode(a.subNodes[r])&&(""===o.id?(a.subNodes[r]=[],a.subNodes[r].push(s)):(a.subNodes[r]={},a.subNodes[r][s.id]=s)),""===o.id?a.subNodes[r].push(i):a.subNodes[r][o.id]=i}else"number"==typeof o.id||o.id.match(/^\d+$/)?(a.subNodes[r]={},a.subNodes[r][o.id]=i):a.subNodes[r]=i;n&&(i.id=o.id,i.attrName=o.name,i.attrType=o.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode(),a=o.name;if(void 0!==a&&a.match(/Properties(\d)+/))return void this.parseNodeSpecialProperty(e,n,i);if("C"===n){var s=i.split(",").slice(1),l=parseInt(s[0]),u=parseInt(s[1]),c=i.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[l,u],c=c.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===o.properties[n]&&(o.properties[n]=[])}if("Node"===n){var h=parseInt(i);o.properties.id=h,o.id=h}n in o.properties?Array.isArray(o.properties[n])?o.properties[n].push(i):o.properties[n]+=i:Array.isArray(o.properties[n])?o.properties[n].push(i):o.properties[n]=i,this.setCurrentProp(o.properties,n),"a"===n&&","!==i.slice(-1)&&(o.properties.a=C(i))},parseNodePropertyContinued:function(e){if(this.currentProp[this.currentPropName]+=e,","!==e.slice(-1)){var t=this.getCurrentNode();t.properties.a=C(t.properties.a)}},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=n[0],o=n[1],a=n[2],s=n[3],l=n[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":l=parseInt(l);break;case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=C(l)}this.getPrevNode().properties[i]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode().properties,i)},nodeEnd:function(){this.popStack()},isFlattenNode:function(e){return"subNodes"in e&&"properties"in e}}),Object.assign(x.prototype,{parse:function(e){var t=new R(e);t.skip(23);var r=t.getUint32();console.log("FBXLoader: FBX binary version: "+r);for(var n=new S;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&n.add(i.name,i)}return n},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r=t>=7500?e.getUint64():e.getUint32(),n=t>=7500?e.getUint64():e.getUint32(),i=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),o=e.getString(i);if(0===r)return null;for(var a=[],s=0;s<n;s++)a.push(this.parseProperty(e));var l=a.length>0?a[0]:"",u=a.length>1?a[1]:"",c=a.length>2?a[2]:"",h={},d={},p=!1;for(1===n&&e.getOffset()===r&&(p=!0);r>e.getOffset();){var f=this.parseNode(e,t);if(null!==f)if(!0!==f.singleProperty)if("Connections"!==o||"C"!==f.name){if("Properties70"!==f.name)if("Properties70"!==o||"P"!==f.name)void 0===h[f.name]?"number"==typeof f.id?(h[f.name]={},h[f.name][f.id]=f):h[f.name]=f:""===f.id?(Array.isArray(h[f.name])||(h[f.name]=[h[f.name]]),h[f.name].push(f)):void 0===h[f.name][f.id]?h[f.name][f.id]=f:(Array.isArray(h[f.name][f.id])||(h[f.name][f.id]=[h[f.name][f.id]]),h[f.name][f.id].push(f));else{var m,v=f.propertyList[0],g=f.propertyList[1],_=f.propertyList[2],b=f.propertyList[3];0===v.indexOf("Lcl ")&&(v=v.replace("Lcl ","Lcl_")),0===g.indexOf("Lcl ")&&(g=g.replace("Lcl ","Lcl_")),m="ColorRGB"===g||"Vector"===g||"Vector3D"===g||0===g.indexOf("Lcl_")?[f.propertyList[4],f.propertyList[5],f.propertyList[6]]:f.propertyList[4],d[v]={type:g,type2:_,flag:b,value:m}}else Object.keys(f.properties).forEach((function(e){d[e]=f.properties[e]}))}else{var y=[];f.propertyList.forEach((function(e,t){y[t-1]=e})),void 0===d.connections&&(d.connections=[]),d.connections.push(y)}else{var w=f.propertyList[0];Array.isArray(w)?(h[f.name]=f,f.properties.a=w):d[f.name]=w}}return{singleProperty:p,id:l,attrName:u,attrType:c,name:o,properties:d,propertyList:a,subNodes:h}},parseProperty:function(e){var t=e.getChar();switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(0===o)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}var s=new R(i.inflate(new Uint8Array(e.getArrayBuffer(a))).buffer);switch(t){case"b":case"c":return s.getBooleanArray(n);case"d":return s.getFloat64Array(n);case"f":return s.getFloat32Array(n);case"i":return s.getInt32Array(n);case"l":return s.getInt64Array(n)}default:throw new Error("FBXLoader: Unknown property type "+t)}}}),Object.assign(R.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getInt8:function(){var e=this.dv.getInt8(this.offset);return this.offset+=1,e},getInt8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt8());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint8());return t},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt16());return t},getUint16:function(){var e=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},getUint16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint16());return t},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getUint32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint32());return t},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getUint64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint64());return t},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getChar:function(){return String.fromCharCode(this.getUint8())},getString:function(e){var t=this.getArrayBuffer(e);return o.LoaderUtils.decodeText(t)}}),Object.assign(S.prototype,{add:function(e,t){this[e]=t}}),FBXLoader}()},function(e,t){e.exports="uniform vec3 diffuse;\nuniform float opacity;\nvarying float positionY;\nvarying float vAlpha;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t// vAplha varie entre 1 et 0 et s'adapte à l'opacity actuelle pour ne jamais dépasser 1\n\tfloat customAlpha = opacity + (1.0 - opacity) * vAlpha;\n\tvec4 diffuseColor = vec4( diffuse, customAlpha );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t// after using texture png with diffuse color\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},function(e,t){e.exports="uniform float size;\nuniform float scale;\nuniform float time;\nvarying float positionY;\nattribute float alphaOffset;\nattribute float alphaSpeed;\nvarying float vAlpha;\nattribute vec3 customColor;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t// Tips for osscillate value:\n\t// sin(value) * Amplitude / 2 + (Amplitude / 2 + min)\n\tvAlpha = sin((alphaOffset + time) / 50.0 * alphaSpeed) * 0.5 + 0.5; // alpha between 0 & 1\n\tgl_PointSize = size * (sin((position.y + time) / 65.0) * 0.75 + 2.25); // size\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}"},function(e,t){e.exports="uniform sampler2D baseTexture;\nuniform sampler2D bloomTexture;\n\nvarying vec2 vUv;\n\nvec4 getTexture( sampler2D texelToLinearTexture ) {\n\n\treturn mapTexelToLinear( texture2D( texelToLinearTexture , vUv ) );\n\n}\n\nvoid main() {\n\n\tgl_FragColor = ( getTexture( baseTexture ) + vec4( 1.0 ) * getTexture( bloomTexture ) );\n\n}"},function(e,t){e.exports="varying vec2 vUv;\n\nvoid main() {\n\n\tvUv = uv;\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}"},function(e,t,r){var n=r(2),i=r(19),o=r(22),a=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,h,d,p,f=0,m=!1,v=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function _(t){var r=l,n=u;return l=u=void 0,f=t,h=e.apply(n,r)}function b(e){return f=e,d=setTimeout(w,t),m?_(e):h}function y(e){var r=e-p;return void 0===p||r>=t||r<0||v&&e-f>=c}function w(){var e=i();if(y(e))return E(e);d=setTimeout(w,function(e){var r=t-(e-p);return v?s(r,c-(e-f)):r}(e))}function E(e){return d=void 0,g&&l?_(e):(l=u=void 0,h)}function T(){var e=i(),r=y(e);if(l=arguments,u=this,p=e,r){if(void 0===d)return b(p);if(v)return clearTimeout(d),d=setTimeout(w,t),_(p)}return void 0===d&&(d=setTimeout(w,t)),h}return t=o(t)||0,n(r)&&(m=!!r.leading,c=(v="maxWait"in r)?a(o(r.maxWait)||0,t):c,g="trailing"in r?!!r.trailing:g),T.cancel=function(){void 0!==d&&clearTimeout(d),f=0,l=p=u=d=void 0},T.flush=function(){return void 0===d?h:E(i())},T}},function(e,t,r){var n=r(4);e.exports=function(){return n.Date.now()}},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(21))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(2),i=r(23),o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=s.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):a.test(e)?NaN:+e}},function(e,t,r){var n=r(24),i=r(27);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},function(e,t,r){var n=r(5),i=r(25),o=r(26),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},function(e,t,r){var n=r(5),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=a.call(e);return n&&(t?e[s]=r:delete e[s]),i}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){THREE.OrbitControls=function(e,t){var r,n,i,o,a;void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(l),s.update(),d=h.NONE},this.update=(r=new THREE.Vector3,n=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=n.clone().inverse(),o=new THREE.Vector3,a=new THREE.Quaternion,function(){var e=s.object.position;return r.copy(e).sub(s.target),r.applyQuaternion(n),f.setFromVector3(r),s.autoRotate&&d===h.NONE&&C(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(f.theta+=m.theta*s.dampingFactor,f.phi+=m.phi*s.dampingFactor):(f.theta+=m.theta,f.phi+=m.phi),f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta)),f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=v,f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius)),!0===s.enableDamping?s.target.addScaledVector(g,s.dampingFactor):s.target.add(g),r.setFromSpherical(f),r.applyQuaternion(i),e.copy(s.target).add(r),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor,g.multiplyScalar(1-s.dampingFactor)):(m.set(0,0,0),g.set(0,0,0)),v=1,!!(_||o.distanceToSquared(s.object.position)>p||8*(1-a.dot(s.object.quaternion))>p)&&(s.dispatchEvent(l),o.copy(s.object.position),a.copy(s.object.quaternion),_=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",$,!1),s.domElement.removeEventListener("mousedown",X,!1),s.domElement.removeEventListener("wheel",Z,!1),s.domElement.removeEventListener("touchstart",Q,!1),s.domElement.removeEventListener("touchend",J,!1),s.domElement.removeEventListener("touchmove",q,!1),document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",W,!1),s.domElement.removeEventListener("keydown",K,!1)};var s=this,l={type:"change"},u={type:"start"},c={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},d=h.NONE,p=1e-6,f=new THREE.Spherical,m=new THREE.Spherical,v=1,g=new THREE.Vector3,_=!1,b=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,T=new THREE.Vector2,x=new THREE.Vector2,R=new THREE.Vector2,S=new THREE.Vector2,A=new THREE.Vector2;function k(){return Math.pow(.95,s.zoomSpeed)}function C(e){m.theta-=e}function M(e){m.phi-=e}var L,O=(L=new THREE.Vector3,function(e,t){L.setFromMatrixColumn(t,0),L.multiplyScalar(-e),g.add(L)}),P=function(){var e=new THREE.Vector3;return function(t,r){!0===s.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),H=function(){var e=new THREE.Vector3;return function(t,r){var n=s.domElement;if(s.object.isPerspectiveCamera){var i=s.object.position;e.copy(i).sub(s.target);var o=e.length();o*=Math.tan(s.object.fov/2*Math.PI/180),O(2*t*o/n.clientHeight,s.object.matrix),P(2*r*o/n.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(O(t*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix),P(r*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function D(e){s.object.isPerspectiveCamera?v/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),_=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function I(e){s.object.isPerspectiveCamera?v*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),_=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function B(e){b.set(e.clientX,e.clientY)}function N(e){E.set(e.clientX,e.clientY)}function F(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,r)}}function z(e){if(1==e.touches.length)E.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);E.set(t,r)}}function U(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);R.set(0,n)}function j(e){if(1==e.touches.length)y.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);y.set(t,r)}w.subVectors(y,b).multiplyScalar(s.rotateSpeed);var n=s.domElement;C(2*Math.PI*w.x/n.clientHeight),M(2*Math.PI*w.y/n.clientHeight),b.copy(y)}function V(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,r)}x.subVectors(T,E).multiplyScalar(s.panSpeed),H(x.x,x.y),E.copy(T)}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);S.set(0,n),A.set(0,Math.pow(S.y/R.y,s.zoomSpeed)),D(A.y),R.copy(S)}function X(e){if(!1!==s.enabled){var t;switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case THREE.MOUSE.DOLLY:if(!1===s.enableZoom)return;!function(e){R.set(e.clientX,e.clientY)}(e),d=h.DOLLY;break;case THREE.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;N(e),d=h.PAN}else{if(!1===s.enableRotate)return;B(e),d=h.ROTATE}break;case THREE.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;B(e),d=h.ROTATE}else{if(!1===s.enablePan)return;N(e),d=h.PAN}break;default:d=h.NONE}d!==h.NONE&&(document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",W,!1),s.dispatchEvent(u))}}function Y(e){if(!1!==s.enabled)switch(e.preventDefault(),d){case h.ROTATE:if(!1===s.enableRotate)return;!function(e){y.set(e.clientX,e.clientY),w.subVectors(y,b).multiplyScalar(s.rotateSpeed);var t=s.domElement;C(2*Math.PI*w.x/t.clientHeight),M(2*Math.PI*w.y/t.clientHeight),b.copy(y),s.update()}(e);break;case h.DOLLY:if(!1===s.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),A.subVectors(S,R),A.y>0?D(k()):A.y<0&&I(k()),R.copy(S),s.update()}(e);break;case h.PAN:if(!1===s.enablePan)return;!function(e){T.set(e.clientX,e.clientY),x.subVectors(T,E).multiplyScalar(s.panSpeed),H(x.x,x.y),E.copy(T),s.update()}(e)}}function W(e){!1!==s.enabled&&(document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",W,!1),s.dispatchEvent(c),d=h.NONE)}function Z(e){!1===s.enabled||!1===s.enableZoom||d!==h.NONE&&d!==h.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(u),function(e){e.deltaY<0?I(k()):e.deltaY>0&&D(k()),s.update()}(e),s.dispatchEvent(c))}function K(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:H(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:H(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:H(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:H(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function Q(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(s.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===s.enableRotate)return;F(e),d=h.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===s.enablePan)return;z(e),d=h.TOUCH_PAN;break;default:d=h.NONE}break;case 2:switch(s.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&U(e),s.enablePan&&z(e)}(e),d=h.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&U(e),s.enableRotate&&F(e)}(e),d=h.TOUCH_DOLLY_ROTATE;break;default:d=h.NONE}break;default:d=h.NONE}d!==h.NONE&&s.dispatchEvent(u)}}function q(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),d){case h.TOUCH_ROTATE:if(!1===s.enableRotate)return;j(e),s.update();break;case h.TOUCH_PAN:if(!1===s.enablePan)return;V(e),s.update();break;case h.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&G(e),s.enablePan&&V(e)}(e),s.update();break;case h.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&G(e),s.enableRotate&&j(e)}(e),s.update();break;default:d=h.NONE}}function J(e){!1!==s.enabled&&(s.dispatchEvent(c),d=h.NONE)}function $(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",$,!1),s.domElement.addEventListener("mousedown",X,!1),s.domElement.addEventListener("wheel",Z,!1),s.domElement.addEventListener("touchstart",Q,!1),s.domElement.addEventListener("touchend",J,!1),s.domElement.addEventListener("touchmove",q,!1),s.domElement.addEventListener("keydown",K,!1),-1===s.domElement.tabIndex&&(s.domElement.tabIndex=0),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.MapControls=function(e,t){THREE.OrbitControls.call(this,e,t),this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE},THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.MapControls.prototype.constructor=THREE.MapControls},function(e,t){var r,n,i;THREE.EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},n=e.getSize(new THREE.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===THREE.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.clock=new THREE.Clock},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,r,n=this.renderer.getRenderTarget(),i=!1,o=this.passes.length;for(r=0;r<o;r++)if(!1!==(t=this.passes[r]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),t.needsSwap){if(i){var a=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(t instanceof THREE.MaskPass?i=!0:t instanceof THREE.ClearMaskPass&&(i=!1))}this.renderer.setRenderTarget(n)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var r=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(r,n),this.renderTarget2.setSize(r,n);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(r,n)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),THREE.Pass.FullScreenQuad=(r=new THREE.OrthographicCamera(-1,1,1,-1,0,1),n=new THREE.PlaneBufferGeometry(2,2),i=function(e){this._mesh=new THREE.Mesh(n,e)},Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,r)}}),i)},function(e,t){THREE.RenderPass=function(e,t,r,n,i){THREE.Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(e,t,r){var n,i,o=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(n=e.getClearColor().getHex(),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(n,i),this.scene.overrideMaterial=null,e.autoClear=o}})},function(e,t){THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")}},function(e,t){THREE.LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new THREE.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")}},function(e,t){THREE.ShaderPass=function(e,t){THREE.Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}})},function(e,t){THREE.UnrealBloomPass=function(e,t,r,n){THREE.Pass.call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new THREE.Vector2(e.x,e.y):new THREE.Vector2(256,256),this.clearColor=new THREE.Color(0,0,0);var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new THREE.WebGLRenderTarget(o,a,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var s=0;s<this.nMips;s++){var l=new THREE.WebGLRenderTarget(o,a,i);l.texture.name="UnrealBloomPass.h"+s,l.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(l);var u=new THREE.WebGLRenderTarget(o,a,i);u.texture.name="UnrealBloomPass.v"+s,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),o=Math.round(o/2),a=Math.round(a/2)}void 0===THREE.LuminosityHighPassShader&&console.error("THREE.UnrealBloomPass relies on THREE.LuminosityHighPassShader");var c=THREE.LuminosityHighPassShader;this.highPassUniforms=THREE.UniformsUtils.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new THREE.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var h=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2),s=0;s<this.nMips;s++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[s])),this.separableBlurMaterials[s].uniforms.texSize.value=new THREE.Vector2(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new THREE.Vector3(1,1,1),new THREE.Vector3(1,1,1),new THREE.Vector3(1,1,1),new THREE.Vector3(1,1,1),new THREE.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===THREE.CopyShader&&console.error("THREE.UnrealBloomPass relies on THREE.CopyShader");var d=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.basic=new THREE.MeshBasicMaterial,this.fsQuad=new THREE.Pass.FullScreenQuad(null)},THREE.UnrealBloomPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.UnrealBloomPass,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),n=Math.round(t/2);this.renderTargetBright.setSize(r,n);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,n),this.renderTargetsVertical[i].setSize(r,n),this.separableBlurMaterials[i].uniforms.texSize.value=new THREE.Vector2(r,n),r=Math.round(r/2),n=Math.round(n/2)},render:function(e,t,r,n,i){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.fsQuad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=THREE.UnrealBloomPass.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[s]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=THREE.UnrealBloomPass.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[s]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[s];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o},getSeperableBlurMaterial:function(e){return new THREE.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new THREE.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),THREE.UnrealBloomPass.BlurDirectionX=new THREE.Vector2(1,0),THREE.UnrealBloomPass.BlurDirectionY=new THREE.Vector2(0,1)},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}THREE.DRACOLoader=function(e){THREE.Loader.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,r,n){var i=this,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&o.setWithCredentials(!0),o.load(e,(function(e){var r={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,r).then(t).catch(n)}),r,n)},decodeDracoFile:function(e,t,r,n){var i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)},decodeGeometry:function(e,t){var r=this;for(var n in t.attributeTypes){var i=t.attributeTypes[n];void 0!==i.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=i.name)}var o,a=JSON.stringify(t);if(THREE.DRACOLoader.taskCache.has(e)){var s=THREE.DRACOLoader.taskCache.get(e);if(s.key===a)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var l=this.workerNextTaskID++,u=e.byteLength,c=this._getWorker(l,u).then((function(r){return o=r,new Promise((function(r,n){o._callbacks[l]={resolve:r,reject:n},o.postMessage({type:"decode",id:l,taskConfig:t,buffer:e},[e])}))})).then((function(e){return r._createGeometry(e.geometry)}));return c.finally((function(){o&&l&&r._releaseTask(o,l)})),THREE.DRACOLoader.taskCache.set(e,{key:a,promise:c}),c},_createGeometry:function(e){var t=new THREE.BufferGeometry;e.index&&t.setIndex(new THREE.BufferAttribute(e.index.array,1));for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r],i=n.name,o=n.array,a=n.itemSize;t.setAttribute(i,new THREE.BufferAttribute(o,a))}return t},_loadLibrary:function(e,t){var r=new THREE.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),new Promise((function(t,n){r.load(e,t,void 0,n)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==("undefined"==typeof WebAssembly?"undefined":r(WebAssembly))||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var i=THREE.DRACOLoader.DRACOWorker.toString(),o=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending},_getWorker:function(e,t){var r=this;return this._initDecoder().then((function(){var n;r.workerPool.length<r.workerLimit?((n=new Worker(r.workerSourceURL))._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)):r.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(n=r.workerPool[r.workerPool.length-1])._taskCosts[e]=t,n._taskLoad+=t,n}))},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),THREE.DRACOLoader.DRACOWorker=function(){var e,t;function r(e,t,r,n,i,o){var a,s,l=o.num_components(),u=r.num_points()*l;switch(i){case Float32Array:a=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,o,a),s=new Float32Array(u);break;case Int8Array:a=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,o,a),s=new Int8Array(u);break;case Int16Array:a=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,o,a),s=new Int16Array(u);break;case Int32Array:a=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,o,a),s=new Int32Array(u);break;case Uint8Array:a=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,o,a),s=new Uint8Array(u);break;case Uint16Array:a=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,o,a),s=new Uint16Array(u);break;case Uint32Array:a=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,o,a),s=new Uint32Array(u);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var c=0;c<u;c++)s[c]=a.GetValue(c);return e.destroy(a),{name:n,array:s,itemSize:l}}onmessage=function(n){var i=n.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var o=i.buffer,a=i.taskConfig;t.then((function(e){var t=e.draco,n=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var l=function(e,t,n,i){var o,a,s=i.attributeIDs,l=i.attributeTypes,u=t.GetEncodedGeometryType(n);if(u===e.TRIANGULAR_MESH)o=new e.Mesh,a=t.DecodeBufferToMesh(n,o);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,a=t.DecodeBufferToPointCloud(n,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var c={index:null,attributes:[]};for(var h in s){var d,p,f=self[l[h]];if(i.useUniqueIDs)p=s[h],d=t.GetAttributeByUniqueId(o,p);else{if(-1===(p=t.GetAttributeId(o,e[s[h]])))continue;d=t.GetAttribute(o,p)}c.attributes.push(r(e,t,o,h,f,d))}if(u===e.TRIANGULAR_MESH){for(var m=o.num_faces(),v=new Uint32Array(3*m),g=new e.DracoInt32Array,_=0;_<m;++_){t.GetFaceFromMesh(o,_,g);for(var b=0;b<3;++b)v[3*_+b]=g.GetValue(b)}c.index={array:v,itemSize:1},e.destroy(g)}return e.destroy(o),c}(t,n,s,a),u=l.attributes.map((function(e){return e.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}finally{t.destroy(s),t.destroy(n)}}))}}},THREE.DRACOLoader.taskCache=new WeakMap,THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},function(e,t,r){"use strict";r.r(t);r(37);THREE.NURBSCurve=function(e,t,r,n,i){THREE.Curve.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(var o=0;o<r.length;++o){var a=r[o];this.controlPoints[o]=new THREE.Vector4(a.x,a.y,a.z,a.w)}},THREE.NURBSCurve.prototype=Object.create(THREE.Curve.prototype),THREE.NURBSCurve.prototype.constructor=THREE.NURBSCurve,THREE.NURBSCurve.prototype.getPoint=function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=THREE.NURBSUtils.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r.w&&r.divideScalar(r.w),new THREE.Vector3(r.x,r.y,r.z)},THREE.NURBSCurve.prototype.getTangent=function(e){var t=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=THREE.NURBSUtils.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,t,1)[1].clone();return r.normalize(),r}},function(e,t){THREE.NURBSUtils={findSpan:function(e,t,r){var n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;for(var i=e,o=n,a=Math.floor((i+o)/2);t<r[a]||t>=r[a+1];)t<r[a]?o=a:i=a,a=Math.floor((i+o)/2);return a},calcBasisFunctions:function(e,t,r,n){var i=[],o=[],a=[];i[0]=1;for(var s=1;s<=r;++s){o[s]=t-n[e+1-s],a[s]=n[e+s]-t;for(var l=0,u=0;u<s;++u){var c=a[u+1],h=o[s-u],d=i[u]/(c+h);i[u]=l+c*d,l=h*d}i[s]=l}return i},calcBSplinePoint:function(e,t,r,n){for(var i=this.findSpan(e,n,t),o=this.calcBasisFunctions(i,n,e,t),a=new THREE.Vector4(0,0,0,0),s=0;s<=e;++s){var l=r[i-e+s],u=o[s],c=l.w*u;a.x+=l.x*c,a.y+=l.y*c,a.z+=l.z*c,a.w+=l.w*u}return a},calcBasisFunctionDerivatives:function(e,t,r,n,i){for(var o=[],a=0;a<=r;++a)o[a]=0;var s=[];for(a=0;a<=n;++a)s[a]=o.slice(0);var l=[];for(a=0;a<=r;++a)l[a]=o.slice(0);l[0][0]=1;for(var u=o.slice(0),c=o.slice(0),h=1;h<=r;++h){u[h]=t-i[e+1-h],c[h]=i[e+h]-t;for(var d=0,p=0;p<h;++p){var f=c[p+1],m=u[h-p];l[h][p]=f+m;var v=l[p][h-1]/l[h][p];l[p][h]=d+f*v,d=m*v}l[h][h]=d}for(h=0;h<=r;++h)s[0][h]=l[h][r];for(p=0;p<=r;++p){var g=0,_=1,b=[];for(a=0;a<=r;++a)b[a]=o.slice(0);b[0][0]=1;for(var y=1;y<=n;++y){var w=0,E=p-y,T=r-y;p>=y&&(b[_][0]=b[g][0]/l[T+1][E],w=b[_][0]*l[E][T]);var x=p-1<=T?y-1:r-p;for(h=E>=-1?1:-E;h<=x;++h)b[_][h]=(b[g][h]-b[g][h-1])/l[T+1][E+h],w+=b[_][h]*l[E+h][T];p<=T&&(b[_][y]=-b[g][y-1]/l[T+1][p],w+=b[_][y]*l[p][T]),s[y][p]=w;h=g;g=_,_=h}}for(p=r,y=1;y<=n;++y){for(h=0;h<=r;++h)s[y][h]*=p;p*=r-y}return s},calcBSplineDerivatives:function(e,t,r,n,i){for(var o=i<e?i:e,a=[],s=this.findSpan(e,n,t),l=this.calcBasisFunctionDerivatives(s,n,e,o,t),u=[],c=0;c<r.length;++c){var h=(p=r[c].clone()).w;p.x*=h,p.y*=h,p.z*=h,u[c]=p}for(var d=0;d<=o;++d){for(var p=u[s-e].clone().multiplyScalar(l[d][0]),f=1;f<=e;++f)p.add(u[s-e+f].clone().multiplyScalar(l[d][f]));a[d]=p}for(d=o+1;d<=i+1;++d)a[d]=new THREE.Vector4(0,0,0);return a},calcKoverI:function(e,t){for(var r=1,n=2;n<=e;++n)r*=n;var i=1;for(n=2;n<=t;++n)i*=n;for(n=2;n<=e-t;++n)i*=n;return r/i},calcRationalCurveDerivatives:function(e){for(var t=e.length,r=[],n=[],i=0;i<t;++i){var o=e[i];r[i]=new THREE.Vector3(o.x,o.y,o.z),n[i]=o.w}for(var a=[],s=0;s<t;++s){var l=r[s].clone();for(i=1;i<=s;++i)l.sub(a[s-i].clone().multiplyScalar(this.calcKoverI(s,i)*n[i]));a[s]=l.divideScalar(n[0])}return a},calcNURBSDerivatives:function(e,t,r,n,i){var o=this.calcBSplineDerivatives(e,t,r,n,i);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(e,t,r,n,i,o,a,s){for(var l=this.findSpan(e,o,r),u=this.findSpan(t,a,n),c=this.calcBasisFunctions(l,o,e,r),h=this.calcBasisFunctions(u,a,t,n),d=[],p=0;p<=t;++p){d[p]=new THREE.Vector4(0,0,0,0);for(var f=0;f<=e;++f){var m=i[l-e+f][u-t+p].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,d[p].add(m.multiplyScalar(c[f]))}}var g=new THREE.Vector4(0,0,0,0);for(p=0;p<=t;++p)g.add(d[p].multiplyScalar(h[p]));g.divideScalar(g.w),s.set(g.x,g.y,g.z)}}},function(e,t,r){"use strict";var n={};(0,r(0).assign)(n,r(39),r(42),r(10)),e.exports=n},function(e,t,r){"use strict";var n=r(40),i=r(0),o=r(8),a=r(3),s=r(9),l=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,c)))throw new Error(a[r]);this._dict_set=!0}}function c(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}u.prototype.push=function(e,t){var r,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(r=n.deflate(s,a))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),s.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=u,t.deflate=c,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},function(e,t,r){"use strict";var n,i=r(0),o=r(41),a=r(6),s=r(7),l=r(3);function u(e,t){return e.msg=l[t],t}function c(e){return(e<<1)-(e>4?9:0)}function h(e){for(var t=e.length;--t>=0;)e[t]=0}function d(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function p(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,d(e.strm)}function f(e,t){e.pending_buf[e.pending++]=t}function m(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function v(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+258,p=u[o+a-1],f=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(r=t)+a]===f&&u[r+a-1]===p&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<d);if(n=258-(d-o),o=d-258,n>a){if(e.match_start=t,a=n,n>=s)break;p=u[o+a-1],f=u[o+a]}}}while((t=h[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function g(e){var t,r,n,o,l,u,c,h,d,p,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-262)){i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=f?n-f:0}while(--r);t=r=f;do{n=e.prev[--t],e.prev[t]=n>=f?n-f:0}while(--r);o+=f}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,h=e.strstart+e.lookahead,d=o,p=void 0,(p=u.avail_in)>d&&(p=d),r=0===p?0:(u.avail_in-=p,i.arraySet(c,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=a(u.adler,c,p,h):2===u.state.wrap&&(u.adler=s(u.adler,c,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function _(e,t){for(var r,n;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=v(e,r)),e.match_length>=3)if(n=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function b(e,t){for(var r,n,i;;){if(e.lookahead<262){if(g(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=v(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(p(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=o._tr_tally(e,0,e.window[e.strstart-1]))&&p(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function y(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):u(e,-2)}function T(e){var t,r=E(e);return 0===r&&((t=e.state).window_size=2*t.w_size,h(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function x(e,t,r,n,o,a){if(!e)return-2;var s=1;if(-1===t&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>9||8!==r||n<8||n>15||t<0||t>9||a<0||a>4)return u(e,-2);8===n&&(n=9);var l=new w;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,T(e)}n=[new y(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(g(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,p(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(p(e,!1),e.strm.avail_out),1)})),new y(4,4,8,4,_),new y(4,5,16,8,_),new y(4,6,32,32,_),new y(4,4,16,16,b),new y(8,16,32,32,b),new y(8,16,128,128,b),new y(8,32,128,256,b),new y(32,128,258,1024,b),new y(32,258,258,4096,b)],t.deflateInit=function(e,t){return x(e,t,8,15,8,0)},t.deflateInit2=x,t.deflateReset=T,t.deflateResetKeep=E,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var r,i,a,l;if(!e||!e.state||t>5||t<0)return e?u(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return u(e,0===e.avail_out?-5:-2);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,f(i,31),f(i,139),f(i,8),i.gzhead?(f(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),f(i,255&i.gzhead.time),f(i,i.gzhead.time>>8&255),f(i,i.gzhead.time>>16&255),f(i,i.gzhead.time>>24&255),f(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),f(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(f(i,255&i.gzhead.extra.length),f(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(f(i,0),f(i,0),f(i,0),f(i,0),f(i,0),f(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),f(i,3),i.status=113);else{var v=8+(i.w_bits-8<<4)<<8;v|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(v|=32),v+=31-v%31,i.status=113,m(i,v),0!==i.strstart&&(m(i,e.adler>>>16),m(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),d(e),a=i.pending,i.pending!==i.pending_buf_size));)f(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),d(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,f(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),d(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,f(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&d(e),i.pending+2<=i.pending_buf_size&&(f(i,255&e.adler),f(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(d(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&c(t)<=c(r)&&4!==t)return u(e,-5);if(666===i.status&&0!==e.avail_in)return u(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var _=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(g(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=258){if(g(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+258;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=258-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==_&&4!==_||(i.status=666),1===_||3===_)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===_&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(h(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),d(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(f(i,255&e.adler),f(i,e.adler>>8&255),f(i,e.adler>>16&255),f(i,e.adler>>24&255),f(i,255&e.total_in),f(i,e.total_in>>8&255),f(i,e.total_in>>16&255),f(i,e.total_in>>24&255)):(m(i,e.adler>>>16),m(i,65535&e.adler)),d(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?u(e,-2):(e.state=null,113===t?u(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var r,n,o,s,l,u,c,d,p=t.length;if(!e||!e.state)return-2;if(2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return-2;for(1===s&&(e.adler=a(e.adler,t,p,0)),r.wrap=0,p>=r.w_size&&(0===s&&(h(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,t,p-r.w_size,r.w_size,0),t=d,p=r.w_size),l=e.avail_in,u=e.next_in,c=e.input,e.avail_in=p,e.next_in=0,e.input=t,g(r);r.lookahead>=3;){n=r.strstart,o=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--o);r.strstart=n,r.lookahead=2,g(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=u,e.input=c,e.avail_in=l,r.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";var n=r(0);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);i(u);var c=new Array(60);i(c);var h=new Array(512);i(h);var d=new Array(256);i(d);var p=new Array(29);i(p);var f,m,v,g=new Array(30);function _(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function y(e){return e<256?h[e]:h[256+(e>>>7)]}function w(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,w(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function T(e,t,r){E(e,r[2*t],r[2*t+1])}function x(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function R(e,t,r){var n,i,o=new Array(16),a=0;for(n=1;n<=15;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=x(o[s]++,s))}}function S(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){e.bi_valid>8?w(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function C(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&k(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!k(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function M(e,t,r){var n,i,s,l,u=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],i=e.pending_buf[e.l_buf+u],u++,0===n?T(e,i,t):(T(e,(s=d[i])+256+1,t),0!==(l=o[s])&&E(e,i-=p[s],l),T(e,s=y(--n),r),0!==(l=a[s])&&E(e,n-=g[s],l))}while(u<e.last_lit);T(e,256,t)}function L(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)C(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],C(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,C(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,m=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)>f&&(o=f,m++),l[2*n+1]=o,n>u||(e.bl_count[o]++,a=0,n>=p&&(a=d[n-p]),s=l[2*n],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(c[2*n+1]+a)));if(0!==m){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,m-=2}while(m>0);for(o=f;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),R(o,u,e.bl_count)}function O(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function P(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<u)do{T(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(T(e,i,e.bl_tree),s--),T(e,16,e.bl_tree),E(e,s-3,2)):s<=10?(T(e,17,e.bl_tree),E(e,s-3,3)):(T(e,18,e.bl_tree),E(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}}i(g);var H=!1;function D(e,t,r,i){E(e,0+(i?1:0),3),function(e,t,r,i){A(e),i&&(w(e,r),w(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}t._tr_init=function(e){H||(!function(){var e,t,r,n,i,l=new Array(16);for(r=0,n=0;n<28;n++)for(p[n]=r,e=0;e<1<<o[n];e++)d[r++]=n;for(d[r-1]=n,i=0,n=0;n<16;n++)for(g[n]=i,e=0;e<1<<a[n];e++)h[i++]=n;for(i>>=7;n<30;n++)for(g[n]=i<<7,e=0;e<1<<a[n]-7;e++)h[256+i++]=n;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,l[8]++;for(;e<=255;)u[2*e+1]=9,e++,l[9]++;for(;e<=279;)u[2*e+1]=7,e++,l[7]++;for(;e<=287;)u[2*e+1]=8,e++,l[8]++;for(R(u,287,l),e=0;e<30;e++)c[2*e+1]=5,c[2*e]=x(e,5);f=new _(u,o,257,286,15),m=new _(c,a,0,30,15),v=new _(new Array(0),s,0,19,7)}(),H=!0),e.l_desc=new b(e.dyn_ltree,f),e.d_desc=new b(e.dyn_dtree,m),e.bl_desc=new b(e.bl_tree,v),e.bi_buf=0,e.bi_valid=0,S(e)},t._tr_stored_block=D,t._tr_flush_block=function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),L(e,e.l_desc),L(e,e.d_desc),a=function(e){var t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),L(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?D(e,t,r,n):4===e.strategy||o===i?(E(e,2+(n?1:0),3),M(e,u,c)):(E(e,4+(n?1:0),3),function(e,t,r,n){var i;for(E(e,t-257,5),E(e,r-1,5),E(e,n-4,4),i=0;i<n;i++)E(e,e.bl_tree[2*l[i]+1],3);P(e,e.dyn_ltree,t-1),P(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),M(e,e.dyn_ltree,e.dyn_dtree)),S(e),n&&A(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(d[r]+256+1)]++,e.dyn_dtree[2*y(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){E(e,2,3),T(e,256,u),function(e){16===e.bi_valid?(w(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,r){"use strict";var n=r(43),i=r(0),o=r(8),a=r(10),s=r(3),l=r(9),u=r(46),c=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);if(this.header=new u,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[r])}function d(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}h.prototype.push=function(e,t){var r,s,l,u,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(p),d.next_out=0,d.avail_out=p),(r=n.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&f&&(r=n.inflateSetDictionary(this.strm,f)),r===a.Z_BUF_ERROR&&!0===m&&(r=a.Z_OK,m=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),u=d.next_out-l,h=o.buf2string(d.output,l),d.next_out=u,d.avail_out=p-u,u&&i.arraySet(d.output,d.output,l,u,0),this.onData(h)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},function(e,t,r){"use strict";var n=r(0),i=r(6),o=r(7),a=r(44),s=r(45);function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function c(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):-2}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,c(e)):-2}function d(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,h(e))):-2}function p(e,t){var r,n;return e?(n=new u,e.state=n,n.window=null,0!==(r=d(e,t))&&(e.state=null),r):-2}var f,m,v=!0;function g(e){if(v){var t;for(f=new n.Buf32(512),m=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,f,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,m,0,e.work,{bits:5}),v=!1}e.lencode=f,e.lenbits=9,e.distcode=m,e.distbits=5}function _(e,t,r,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),n.arraySet(a.window,t,r-i,o,a.wnext),(i-=o)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=h,t.inflateReset2=d,t.inflateResetKeep=c,t.inflateInit=function(e){return p(e,15)},t.inflateInit2=p,t.inflate=function(e,t){var r,u,c,h,d,p,f,m,v,b,y,w,E,T,x,R,S,A,k,C,M,L,O,P,H=0,D=new n.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),d=e.next_out,c=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,m=r.hold,v=r.bits,b=p,y=f,L=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;v<16;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(2&r.wrap&&35615===m){r.check=0,D[0]=255&m,D[1]=m>>>8&255,r.check=o(r.check,D,2,0),m=0,v=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",r.mode=30;break}if(v-=4,M=8+(15&(m>>>=4)),0===r.wbits)r.wbits=M;else if(M>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<M,e.adler=r.check=1,r.mode=512&m?10:12,m=0,v=0;break;case 2:for(;v<16;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(r.flags=m,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=m>>8&1),512&r.flags&&(D[0]=255&m,D[1]=m>>>8&255,r.check=o(r.check,D,2,0)),m=0,v=0,r.mode=3;case 3:for(;v<32;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.head&&(r.head.time=m),512&r.flags&&(D[0]=255&m,D[1]=m>>>8&255,D[2]=m>>>16&255,D[3]=m>>>24&255,r.check=o(r.check,D,4,0)),m=0,v=0,r.mode=4;case 4:for(;v<16;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.head&&(r.head.xflags=255&m,r.head.os=m>>8),512&r.flags&&(D[0]=255&m,D[1]=m>>>8&255,r.check=o(r.check,D,2,0)),m=0,v=0,r.mode=5;case 5:if(1024&r.flags){for(;v<16;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.length=m,r.head&&(r.head.extra_len=m),512&r.flags&&(D[0]=255&m,D[1]=m>>>8&255,r.check=o(r.check,D,2,0)),m=0,v=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((w=r.length)>p&&(w=p),w&&(r.head&&(M=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,u,h,w,M)),512&r.flags&&(r.check=o(r.check,u,w,h)),p-=w,h+=w,r.length-=w),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===p)break e;w=0;do{M=u[h+w++],r.head&&M&&r.length<65536&&(r.head.name+=String.fromCharCode(M))}while(M&&w<p);if(512&r.flags&&(r.check=o(r.check,u,w,h)),p-=w,h+=w,M)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===p)break e;w=0;do{M=u[h+w++],r.head&&M&&r.length<65536&&(r.head.comment+=String.fromCharCode(M))}while(M&&w<p);if(512&r.flags&&(r.check=o(r.check,u,w,h)),p-=w,h+=w,M)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;v<16;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(m!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}m=0,v=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;v<32;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}e.adler=r.check=l(m),m=0,v=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,r.hold=m,r.bits=v,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){m>>>=7&v,v-=7&v,r.mode=27;break}for(;v<3;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}switch(r.last=1&m,v-=1,3&(m>>>=1)){case 0:r.mode=14;break;case 1:if(g(r),r.mode=20,6===t){m>>>=2,v-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}m>>>=2,v-=2;break;case 14:for(m>>>=7&v,v-=7&v;v<32;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&m,m=0,v=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(w=r.length){if(w>p&&(w=p),w>f&&(w=f),0===w)break e;n.arraySet(c,u,h,w,d),p-=w,h+=w,f-=w,d+=w,r.length-=w;break}r.mode=12;break;case 17:for(;v<14;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(r.nlen=257+(31&m),m>>>=5,v-=5,r.ndist=1+(31&m),m>>>=5,v-=5,r.ncode=4+(15&m),m>>>=4,v-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;v<3;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.lens[I[r.have++]]=7&m,m>>>=3,v-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},L=s(0,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,L){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;R=(H=r.lencode[m&(1<<r.lenbits)-1])>>>16&255,S=65535&H,!((x=H>>>24)<=v);){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(S<16)m>>>=x,v-=x,r.lens[r.have++]=S;else{if(16===S){for(P=x+2;v<P;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(m>>>=x,v-=x,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}M=r.lens[r.have-1],w=3+(3&m),m>>>=2,v-=2}else if(17===S){for(P=x+3;v<P;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}v-=x,M=0,w=3+(7&(m>>>=x)),m>>>=3,v-=3}else{for(P=x+7;v<P;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}v-=x,M=0,w=11+(127&(m>>>=x)),m>>>=7,v-=7}if(r.have+w>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;w--;)r.lens[r.have++]=M}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,O={bits:r.lenbits},L=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,L){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},L=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,L){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(p>=6&&f>=258){e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,r.hold=m,r.bits=v,a(e,y),d=e.next_out,c=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,m=r.hold,v=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;R=(H=r.lencode[m&(1<<r.lenbits)-1])>>>16&255,S=65535&H,!((x=H>>>24)<=v);){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(R&&0==(240&R)){for(A=x,k=R,C=S;R=(H=r.lencode[C+((m&(1<<A+k)-1)>>A)])>>>16&255,S=65535&H,!(A+(x=H>>>24)<=v);){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}m>>>=A,v-=A,r.back+=A}if(m>>>=x,v-=x,r.back+=x,r.length=S,0===R){r.mode=26;break}if(32&R){r.back=-1,r.mode=12;break}if(64&R){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&R,r.mode=22;case 22:if(r.extra){for(P=r.extra;v<P;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.length+=m&(1<<r.extra)-1,m>>>=r.extra,v-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;R=(H=r.distcode[m&(1<<r.distbits)-1])>>>16&255,S=65535&H,!((x=H>>>24)<=v);){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(0==(240&R)){for(A=x,k=R,C=S;R=(H=r.distcode[C+((m&(1<<A+k)-1)>>A)])>>>16&255,S=65535&H,!(A+(x=H>>>24)<=v);){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}m>>>=A,v-=A,r.back+=A}if(m>>>=x,v-=x,r.back+=x,64&R){e.msg="invalid distance code",r.mode=30;break}r.offset=S,r.extra=15&R,r.mode=24;case 24:if(r.extra){for(P=r.extra;v<P;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}r.offset+=m&(1<<r.extra)-1,m>>>=r.extra,v-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===f)break e;if(w=y-f,r.offset>w){if((w=r.offset-w)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}w>r.wnext?(w-=r.wnext,E=r.wsize-w):E=r.wnext-w,w>r.length&&(w=r.length),T=r.window}else T=c,E=d-r.offset,w=r.length;w>f&&(w=f),f-=w,r.length-=w;do{c[d++]=T[E++]}while(--w);0===r.length&&(r.mode=21);break;case 26:if(0===f)break e;c[d++]=r.length,f--,r.mode=21;break;case 27:if(r.wrap){for(;v<32;){if(0===p)break e;p--,m|=u[h++]<<v,v+=8}if(y-=f,e.total_out+=y,r.total+=y,y&&(e.adler=r.check=r.flags?o(r.check,c,y,d-y):i(r.check,c,y,d-y)),y=f,(r.flags?m:l(m))!==r.check){e.msg="incorrect data check",r.mode=30;break}m=0,v=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;v<32;){if(0===p)break e;p--,m+=u[h++]<<v,v+=8}if(m!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}m=0,v=0}r.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=f,e.next_in=h,e.avail_in=p,r.hold=m,r.bits=v,(r.wsize||y!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&_(e,e.output,e.next_out,y-e.avail_out)?(r.mode=31,-4):(b-=e.avail_in,y-=e.avail_out,e.total_in+=b,e.total_out+=y,r.total+=y,r.wrap&&y&&(e.adler=r.check=r.flags?o(r.check,c,y,e.next_out-y):i(r.check,c,y,e.next_out-y)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===b&&0===y||4===t)&&0===L&&(L=-5),L)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&i(1,t,n,0)!==r.check?-3:_(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function(e,t){var r,n,i,o,a,s,l,u,c,h,d,p,f,m,v,g,_,b,y,w,E,T,x,R,S;r=e.state,n=e.next_in,R=e.input,i=n+(e.avail_in-5),o=e.next_out,S=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,d=r.window,p=r.hold,f=r.bits,m=r.lencode,v=r.distcode,g=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;e:do{f<15&&(p+=R[n++]<<f,f+=8,p+=R[n++]<<f,f+=8),b=m[p&g];t:for(;;){if(p>>>=y=b>>>24,f-=y,0===(y=b>>>16&255))S[o++]=65535&b;else{if(!(16&y)){if(0==(64&y)){b=m[(65535&b)+(p&(1<<y)-1)];continue t}if(32&y){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&b,(y&=15)&&(f<y&&(p+=R[n++]<<f,f+=8),w+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=R[n++]<<f,f+=8,p+=R[n++]<<f,f+=8),b=v[p&_];r:for(;;){if(p>>>=y=b>>>24,f-=y,!(16&(y=b>>>16&255))){if(0==(64&y)){b=v[(65535&b)+(p&(1<<y)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(E=65535&b,f<(y&=15)&&(p+=R[n++]<<f,(f+=8)<y&&(p+=R[n++]<<f,f+=8)),(E+=p&(1<<y)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=y,f-=y,E>(y=o-a)){if((y=E-y)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=0,x=d,0===h){if(T+=u-y,y<w){w-=y;do{S[o++]=d[T++]}while(--y);T=o-E,x=S}}else if(h<y){if(T+=u+h-y,(y-=h)<w){w-=y;do{S[o++]=d[T++]}while(--y);if(T=0,h<w){w-=y=h;do{S[o++]=d[T++]}while(--y);T=o-E,x=S}}}else if(T+=h-y,y<w){w-=y;do{S[o++]=d[T++]}while(--y);T=o-E,x=S}for(;w>2;)S[o++]=x[T++],S[o++]=x[T++],S[o++]=x[T++],w-=3;w&&(S[o++]=x[T++],w>1&&(S[o++]=x[T++]))}else{T=o-E;do{S[o++]=S[T++],S[o++]=S[T++],S[o++]=S[T++],w-=3}while(w>2);w&&(S[o++]=S[T++],w>1&&(S[o++]=S[T++]))}break}}break}}while(n<i&&o<s);n-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=f}},function(e,t,r){"use strict";var n=r(0),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,l,u,c,h,d){var p,f,m,v,g,_,b,y,w,E=d.bits,T=0,x=0,R=0,S=0,A=0,k=0,C=0,M=0,L=0,O=0,P=null,H=0,D=new n.Buf16(16),I=new n.Buf16(16),B=null,N=0;for(T=0;T<=15;T++)D[T]=0;for(x=0;x<l;x++)D[t[r+x]]++;for(A=E,S=15;S>=1&&0===D[S];S--);if(A>S&&(A=S),0===S)return u[c++]=20971520,u[c++]=20971520,d.bits=1,0;for(R=1;R<S&&0===D[R];R++);for(A<R&&(A=R),M=1,T=1;T<=15;T++)if(M<<=1,(M-=D[T])<0)return-1;if(M>0&&(0===e||1!==S))return-1;for(I[1]=0,T=1;T<15;T++)I[T+1]=I[T]+D[T];for(x=0;x<l;x++)0!==t[r+x]&&(h[I[t[r+x]]++]=x);if(0===e?(P=B=h,_=19):1===e?(P=i,H-=257,B=o,N-=257,_=256):(P=a,B=s,_=-1),O=0,x=0,T=R,g=c,k=A,C=0,m=-1,v=(L=1<<A)-1,1===e&&L>852||2===e&&L>592)return 1;for(;;){b=T-C,h[x]<_?(y=0,w=h[x]):h[x]>_?(y=B[N+h[x]],w=P[H+h[x]]):(y=96,w=0),p=1<<T-C,R=f=1<<k;do{u[g+(O>>C)+(f-=p)]=b<<24|y<<16|w|0}while(0!==f);for(p=1<<T-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,x++,0==--D[T]){if(T===S)break;T=t[r+h[x]]}if(T>A&&(O&v)!==m){for(0===C&&(C=A),g+=R,M=1<<(k=T-C);k+C<S&&!((M-=D[k+C])<=0);)k++,M<<=1;if(L+=1<<k,1===e&&L>852||2===e&&L>592)return 1;u[m=O&v]=A<<24|k<<16|g-c|0}}return 0!==O&&(u[g+O]=T-C<<24|64<<16|0),d.bits=A,0}},function(e,t,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,r){},function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new window.CustomEvent(e,{detail:t});return r}r.r(t);var i={tree:131586,particles:676899,lines:5599832,lines2:1587720,lines3:1736035,lines4:1735979};function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"handleRAF",(function(e){window.dispatchEvent(n("RAF",{now:e})),t.raf=window.requestAnimationFrame(t.handleRAF)})),o(this,"start",(function(){t.handleRAF(0)})),o(this,"pause",(function(){window.cancelAnimationFrame(t.raf)})),window.addEventListener("START_SCENE",this.start)};var a=r(11),s=r.n(a);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=window.innerWidth,this.height=window.innerHeight,this.handleResize=s()(this.handleResize,100,{leading:!1}),window.addEventListener("resize",this.handleResize,{passive:!0})}var t,r,i;return t=e,(r=[{key:"handleResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,window.dispatchEvent(n("WINDOW_RESIZE",{width:this.width,height:this.height}))}}])&&l(t.prototype,r),i&&l(t,i),e}()),r(28),r(29),r(30),r(31),r(32),r(33),r(34);var u=r(12),c=r.n(u);function h(e,t){var r=e.__state.conversionName.toString(),n=Math.round(e.r),i=Math.round(e.g),o=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===r||"SIX_CHAR_HEX"===r){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===r?"rgb("+n+","+i+","+o+")":"CSS_RGBA"===r?"rgba("+n+","+i+","+o+","+a+")":"HEX"===r?"0x"+e.hex.toString(16):"RGB_ARRAY"===r?"["+n+","+i+","+o+"]":"RGBA_ARRAY"===r?"["+n+","+i+","+o+","+a+"]":"RGB_OBJ"===r?"{r:"+n+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===r?"{r:"+n+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===r?"{h:"+s+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===r?"{h:"+s+",s:"+l+",v:"+u+",a:"+a+"}":"unknown format"}var d=Array.prototype.forEach,p=Array.prototype.slice,f={BREAK:{},extend:function(e){return this.each(p.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))}),this),e},defaults:function(e){return this.each(p.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))}),this),e},compose:function(){var e=p.call(arguments);return function(){for(var t=p.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e)if(d&&e.forEach&&e.forEach===d)e.forEach(t,r);else if(e.length===e.length+0){var n,i=void 0;for(i=0,n=e.length;i<n;i++)if(i in e&&t.call(r,e[i],i)===this.BREAK)return}else for(var o in e)if(t.call(r,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var n=void 0;return function(){var i=this,o=arguments;function a(){n=null,r||e.apply(i,o)}var s=r||!n;clearTimeout(n),n=setTimeout(a,t),s&&e.apply(i,o)}},toArray:function(e){return e.toArray?e.toArray():p.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},m=[{litmus:f.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:h},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:h},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:h},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:h}}},{litmus:f.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:f.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:f.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(f.isNumber(e.r)&&f.isNumber(e.g)&&f.isNumber(e.b)&&f.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(f.isNumber(e.r)&&f.isNumber(e.g)&&f.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(f.isNumber(e.h)&&f.isNumber(e.s)&&f.isNumber(e.v)&&f.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(f.isNumber(e.h)&&f.isNumber(e.s)&&f.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],v=void 0,g=void 0,_=function(){g=!1;var e=arguments.length>1?f.toArray(arguments):arguments[0];return f.each(m,(function(t){if(t.litmus(e))return f.each(t.conversions,(function(t,r){if(v=t.read(e),!1===g&&!1!==v)return g=v,v.conversionName=r,v.conversion=t,f.BREAK})),f.BREAK})),g},b=void 0,y={hsv_to_rgb:function(e,t,r){var n=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=[[r,s,o],[a,r,o],[o,r,s],[o,a,r],[s,o,r],[r,o,a]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,r){var n=Math.min(e,t,r),i=Math.max(e,t,r),o=i-n,a=void 0;return 0===i?{h:NaN,s:0,v:0}:(a=e===i?(t-r)/o:t===i?2+(r-e)/o:4+(e-t)/o,(a/=6)<0&&(a+=1),{h:360*a,s:o/i,v:i/255})},rgb_to_hex:function(e,t,r){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,r)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,r){return r<<(b=8*t)|e&~(255<<b)}},w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},T=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),x=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},R=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},S=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},A=function(){function e(){if(E(this,e),this.__state=_.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return T(e,[{key:"toString",value:function(){return h(this)}},{key:"toHexString",value:function(){return h(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function k(e,t,r){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||A.recalculateRGB(this,t,r),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(A.recalculateRGB(this,t,r),this.__state.space="RGB"),this.__state[t]=e}})}function C(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||A.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(A.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}A.recalculateRGB=function(e,t,r){if("HEX"===e.__state.space)e.__state[t]=y.component_from_hex(e.__state.hex,r);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");f.extend(e.__state,y.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},A.recalculateHSV=function(e){var t=y.rgb_to_hsv(e.r,e.g,e.b);f.extend(e.__state,{s:t.s,v:t.v}),f.isNaN(t.h)?f.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},A.COMPONENTS=["r","g","b","h","s","v","hex","a"],k(A.prototype,"r",2),k(A.prototype,"g",1),k(A.prototype,"b",0),C(A.prototype,"h"),C(A.prototype,"s"),C(A.prototype,"v"),Object.defineProperty(A.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(A.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=y.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var M=function(){function e(t,r){E(this,e),this.initialValue=t[r],this.domElement=document.createElement("div"),this.object=t,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return T(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),L={};f.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){f.each(e,(function(e){L[e]=t}))}));var O=/(\d+(\.\d+)?)px/;function P(e){if("0"===e||f.isUndefined(e))return 0;var t=e.match(O);return f.isNull(t)?0:parseFloat(t[1])}var H={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var n=r,i=t;f.isUndefined(i)&&(i=!0),f.isUndefined(n)&&(n=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,n){var i=r||{},o=L[t];if(!o)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":var s=i.x||i.clientX||0,l=i.y||i.clientY||0;a.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,s,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=a.initKeyboardEvent||a.initKeyEvent;f.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:a.initEvent(t,i.bubbles||!1,i.cancelable||!0)}f.defaults(a,n),e.dispatchEvent(a)},bind:function(e,t,r,n){var i=n||!1;return e.addEventListener?e.addEventListener(t,r,i):e.attachEvent&&e.attachEvent("on"+t,r),H},unbind:function(e,t,r,n){var i=n||!1;return e.removeEventListener?e.removeEventListener(t,r,i):e.detachEvent&&e.detachEvent("on"+t,r),H},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return H},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))}else e.className=void 0;return H},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return P(t["border-left-width"])+P(t["border-right-width"])+P(t["padding-left"])+P(t["padding-right"])+P(t.width)},getHeight:function(e){var t=getComputedStyle(e);return P(t["border-top-width"])+P(t["border-bottom-width"])+P(t["padding-top"])+P(t["padding-bottom"])+P(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do{r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent}while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},D=function(e){function t(e,r){E(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),i=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),H.bind(n.__checkbox,"change",(function(){i.setValue(!i.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return R(t,e),T(t,[{key:"setValue",value:function(e){var r=x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(M),I=function(e){function t(e,r,n){E(this,t);var i=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=n,a=i;if(i.__select=document.createElement("select"),f.isArray(o)){var s={};f.each(o,(function(e){s[e]=e})),o=s}return f.each(o,(function(e,t){var r=document.createElement("option");r.innerHTML=t,r.setAttribute("value",e),a.__select.appendChild(r)})),i.updateDisplay(),H.bind(i.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),i.domElement.appendChild(i.__select),i}return R(t,e),T(t,[{key:"setValue",value:function(e){var r=x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return H.isActive(this.__select)?this:(this.__select.value=this.getValue(),x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(M),B=function(e){function t(e,r){E(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),i=n;function o(){i.setValue(i.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),H.bind(n.__input,"keyup",o),H.bind(n.__input,"change",o),H.bind(n.__input,"blur",(function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())})),H.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return R(t,e),T(t,[{key:"updateDisplay",value:function(){return H.isActive(this.__input)||(this.__input.value=this.getValue()),x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(M);function N(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var F=function(e){function t(e,r,n){E(this,t);var i=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=n||{};return i.__min=o.min,i.__max=o.max,i.__step=o.step,f.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=N(i.__impliedStep),i}return R(t,e),T(t,[{key:"setValue",value:function(e){var r=e;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=N(e),this}}]),t}(M);var z=function(e){function t(e,r,n){E(this,t);var i=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));i.__truncationSuspended=!1;var o=i,a=void 0;function s(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function l(e){var t=a-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),a=e.clientY}function u(){H.unbind(window,"mousemove",l),H.unbind(window,"mouseup",u),s()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),H.bind(i.__input,"change",(function(){var e=parseFloat(o.__input.value);f.isNaN(e)||o.setValue(e)})),H.bind(i.__input,"blur",(function(){s()})),H.bind(i.__input,"mousedown",(function(e){H.bind(window,"mousemove",l),H.bind(window,"mouseup",u),a=e.clientY})),H.bind(i.__input,"keydown",(function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,s())})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return R(t,e),T(t,[{key:"updateDisplay",value:function(){var e,r,n;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),r=this.__precision,n=Math.pow(10,r),Math.round(e*n)/n),x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(F);function U(e,t,r,n,i){return n+(e-t)/(r-t)*(i-n)}var j=function(e){function t(e,r,n,i,o){E(this,t);var a=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,{min:n,max:i,step:o})),s=a;function l(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(U(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function u(){H.unbind(window,"mousemove",l),H.unbind(window,"mouseup",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(e){var t=e.touches[0].clientX,r=s.__background.getBoundingClientRect();s.setValue(U(t,r.left,r.right,s.__min,s.__max))}function h(){H.unbind(window,"touchmove",c),H.unbind(window,"touchend",h),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),H.bind(a.__background,"mousedown",(function(e){document.activeElement.blur(),H.bind(window,"mousemove",l),H.bind(window,"mouseup",u),l(e)})),H.bind(a.__background,"touchstart",(function(e){if(1!==e.touches.length)return;H.bind(window,"touchmove",c),H.bind(window,"touchend",h),c(e)})),H.addClass(a.__background,"slider"),H.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return R(t,e),T(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",x(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(F),V=function(e){function t(e,r,n){E(this,t);var i=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===n?"Fire":n,H.bind(i.__button,"click",(function(e){return e.preventDefault(),o.fire(),!1})),H.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return R(t,e),T(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(M),G=function(e){function t(e,r){E(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));n.__color=new A(n.getValue()),n.__temp=new A(0);var i=n;n.domElement=document.createElement("div"),H.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",H.bind(n.__input,"keydown",(function(e){13===e.keyCode&&h.call(this)})),H.bind(n.__input,"blur",h),H.bind(n.__selector,"mousedown",(function(){H.addClass(this,"drag").bind(window,"mouseup",(function(){H.removeClass(i.__selector,"drag")}))})),H.bind(n.__selector,"touchstart",(function(){H.addClass(this,"drag").bind(window,"touchend",(function(){H.removeClass(i.__selector,"drag")}))}));var o,a=document.createElement("div");function s(e){p(e),H.bind(window,"mousemove",p),H.bind(window,"touchmove",p),H.bind(window,"mouseup",u),H.bind(window,"touchend",u)}function l(e){m(e),H.bind(window,"mousemove",m),H.bind(window,"touchmove",m),H.bind(window,"mouseup",c),H.bind(window,"touchend",c)}function u(){H.unbind(window,"mousemove",p),H.unbind(window,"touchmove",p),H.unbind(window,"mouseup",u),H.unbind(window,"touchend",u),d()}function c(){H.unbind(window,"mousemove",m),H.unbind(window,"touchmove",m),H.unbind(window,"mouseup",c),H.unbind(window,"touchend",c),d()}function h(){var e=_(this.value);!1!==e?(i.__color.__state=e,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function d(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__saturation_field.getBoundingClientRect(),r=e.touches&&e.touches[0]||e,n=r.clientX,o=r.clientY,a=(n-t.left)/(t.right-t.left),s=1-(o-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),i.__color.v=s,i.__color.s=a,i.setValue(i.__color.toOriginal()),!1}function m(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__hue_field.getBoundingClientRect(),r=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),i.__color.h=360*r,i.setValue(i.__color.toOriginal()),!1}return f.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),f.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),f.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),f.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),f.extend(a.style,{width:"100%",height:"100%",background:"none"}),Y(a,"top","rgba(0,0,0,0)","#000"),f.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=n.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",f.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),H.bind(n.__saturation_field,"mousedown",s),H.bind(n.__saturation_field,"touchstart",s),H.bind(n.__field_knob,"mousedown",s),H.bind(n.__field_knob,"touchstart",s),H.bind(n.__hue_field,"mousedown",l),H.bind(n.__hue_field,"touchstart",l),n.__saturation_field.appendChild(a),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return R(t,e),T(t,[{key:"updateDisplay",value:function(){var e=_(this.getValue());if(!1!==e){var t=!1;f.each(A.COMPONENTS,(function(r){if(!f.isUndefined(e[r])&&!f.isUndefined(this.__color.__state[r])&&e[r]!==this.__color.__state[r])return t=!0,{}}),this),t&&f.extend(this.__color.__state,e)}f.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,n=255-r;f.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,Y(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),f.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(M),X=["-moz-","-o-","-webkit-","-ms-",""];function Y(e,t,r,n){e.style.background="",f.each(X,(function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+r+" 0%, "+n+" 100%); "}))}var W=function(e,t){var r=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var i=r.getElementsByTagName("head")[0];try{i.appendChild(n)}catch(e){}},Z='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',K=function(e,t){var r=e[t];return f.isArray(arguments[2])||f.isObject(arguments[2])?new I(e,t,arguments[2]):f.isNumber(r)?f.isNumber(arguments[2])&&f.isNumber(arguments[3])?f.isNumber(arguments[4])?new j(e,t,arguments[2],arguments[3],arguments[4]):new j(e,t,arguments[2],arguments[3]):f.isNumber(arguments[4])?new z(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new z(e,t,{min:arguments[2],max:arguments[3]}):f.isString(r)?new B(e,t):f.isFunction(r)?new V(e,t,""):f.isBoolean(r)?new D(e,t):null};var Q=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},q=function(){function e(){E(this,e),this.backgroundElement=document.createElement("div"),f.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),H.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),f.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;H.bind(this.backgroundElement,"click",(function(){t.hide()}))}return T(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),f.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",H.unbind(e.domElement,"webkitTransitionEnd",t),H.unbind(e.domElement,"transitionend",t),H.unbind(e.domElement,"oTransitionEnd",t)};H.bind(this.domElement,"webkitTransitionEnd",t),H.bind(this.domElement,"transitionend",t),H.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-H.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-H.getHeight(this.domElement)/2+"px"}}]),e}();W(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var J=function(){try{return!!window.localStorage}catch(e){return!1}}(),$=void 0,ee=!0,te=void 0,re=!1,ne=[],ie=function e(t){var r=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),H.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=f.defaults(n,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),n=f.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),f.isUndefined(n.load)?n.load={preset:"Default"}:n.preset&&(n.load.preset=n.preset),f.isUndefined(n.parent)&&n.hideable&&ne.push(this),n.resizable=f.isUndefined(n.parent)&&n.resizable,n.autoPlace&&f.isUndefined(n.scrollable)&&(n.scrollable=!0);var i,o=J&&"true"===localStorage.getItem(ce(this,"isLocal")),a=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return r.parent?r.getRoot().preset:n.load.preset},set:function(e){r.parent?r.getRoot().preset=e:n.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),r.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,me(r,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,s&&(s.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(t){n.closed=t,n.closed?H.addClass(r.__ul,e.CLASS_CLOSED):H.removeClass(r.__ul,e.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return o},set:function(e){J&&(o=e,e?H.bind(window,"unload",a):H.unbind(window,"unload",a),localStorage.setItem(ce(r,"isLocal"),e))}}}),f.isUndefined(n.parent)){if(this.closed=n.closed||!1,H.addClass(this.domElement,e.CLASS_MAIN),H.makeSelectable(this.domElement,!1),J&&o){r.useLocalStorage=!0;var l=localStorage.getItem(ce(this,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,H.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),n.closeOnTop?(H.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(H.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),H.bind(this.__closeButton,"click",(function(){r.closed=!r.closed}))}else{void 0===n.closed&&(n.closed=!0);var u=document.createTextNode(n.name);H.addClass(u,"controller-name"),s=oe(r,u);H.addClass(this.__ul,e.CLASS_CLOSED),H.addClass(s,"title"),H.bind(s,"click",(function(e){return e.preventDefault(),r.closed=!r.closed,!1})),n.closed||(this.closed=!1)}n.autoPlace&&(f.isUndefined(n.parent)&&(ee&&(te=document.createElement("div"),H.addClass(te,"dg"),H.addClass(te,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(te),ee=!1),te.appendChild(this.domElement),H.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||me(r,n.width)),this.__resizeHandler=function(){r.onResizeDebounced()},H.bind(window,"resize",this.__resizeHandler),H.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),H.bind(this.__ul,"transitionend",this.__resizeHandler),H.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&fe(this),a=function(){J&&"true"===localStorage.getItem(ce(r,"isLocal"))&&localStorage.setItem(ce(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=a,n.parent||((i=r.getRoot()).width+=1,f.defer((function(){i.width-=1})))};function oe(e,t,r){var n=document.createElement("li");return t&&n.appendChild(t),r?e.__ul.insertBefore(n,r):e.__ul.appendChild(n),e.onResize(),n}function ae(e){H.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&H.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function se(e,t){var r=e.__preset_select[e.__preset_select.selectedIndex];r.innerHTML=t?r.value+"*":r.value}function le(e,t){var r=e.getRoot(),n=r.__rememberedObjects.indexOf(t.object);if(-1!==n){var i=r.__rememberedObjectIndecesToControllers[n];if(void 0===i&&(i={},r.__rememberedObjectIndecesToControllers[n]=i),i[t.property]=t,r.load&&r.load.remembered){var o=r.load.remembered,a=void 0;if(o[e.preset])a=o[e.preset];else{if(!o.Default)return;a=o.Default}if(a[n]&&void 0!==a[n][t.property]){var s=a[n][t.property];t.initialValue=s,t.setValue(s)}}}}function ue(e,t,r,n){if(void 0===t[r])throw new Error('Object "'+t+'" has no property "'+r+'"');var i=void 0;if(n.color)i=new G(t,r);else{var o=[t,r].concat(n.factoryArgs);i=K.apply(e,o)}n.before instanceof M&&(n.before=n.before.__li),le(e,i),H.addClass(i.domElement,"c");var a=document.createElement("span");H.addClass(a,"property-name"),a.innerHTML=i.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(i.domElement);var l=oe(e,s,n.before);return H.addClass(l,ie.CLASS_CONTROLLER_ROW),i instanceof G?H.addClass(l,"color"):H.addClass(l,w(i.getValue())),function(e,t,r){if(r.__li=t,r.__gui=e,f.extend(r,{options:function(t){if(arguments.length>1){var n=r.__li.nextElementSibling;return r.remove(),ue(e,r.object,r.property,{before:n,factoryArgs:[f.toArray(arguments)]})}if(f.isArray(t)||f.isObject(t)){var i=r.__li.nextElementSibling;return r.remove(),ue(e,r.object,r.property,{before:i,factoryArgs:[t]})}},name:function(e){return r.__li.firstElementChild.firstElementChild.innerHTML=e,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof j){var n=new z(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});f.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=r[e],i=n[e];r[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(n,e),t.apply(r,e)}})),H.addClass(t,"has-slider"),r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof z){var i=function(t){if(f.isNumber(r.__min)&&f.isNumber(r.__max)){var n=r.__li.firstElementChild.firstElementChild.innerHTML,i=r.__gui.__listening.indexOf(r)>-1;r.remove();var o=ue(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]});return o.name(n),i&&o.listen(),o}return t};r.min=f.compose(i,r.min),r.max=f.compose(i,r.max)}else r instanceof D?(H.bind(t,"click",(function(){H.fakeEvent(r.__checkbox,"click")})),H.bind(r.__checkbox,"click",(function(e){e.stopPropagation()}))):r instanceof V?(H.bind(t,"click",(function(){H.fakeEvent(r.__button,"click")})),H.bind(t,"mouseover",(function(){H.addClass(r.__button,"hover")})),H.bind(t,"mouseout",(function(){H.removeClass(r.__button,"hover")}))):r instanceof G&&(H.addClass(t,"color"),r.updateDisplay=f.compose((function(e){return t.style.borderLeftColor=r.__color.toString(),e}),r.updateDisplay),r.updateDisplay());r.setValue=f.compose((function(t){return e.getRoot().__preset_select&&r.isModified()&&se(e.getRoot(),!0),t}),r.setValue)}(e,l,i),e.__controllers.push(i),i}function ce(e,t){return document.location.href+"."+t}function he(e,t,r){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),r&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function de(e,t){t.style.display=e.useLocalStorage?"block":"none"}function pe(e){var t=e.__save_row=document.createElement("li");H.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),H.addClass(t,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",H.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save",H.addClass(n,"button"),H.addClass(n,"save");var i=document.createElement("span");i.innerHTML="New",H.addClass(i,"button"),H.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",H.addClass(o,"button"),H.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?f.each(e.load.remembered,(function(t,r){he(e,r,r===e.preset)})):he(e,"Default",!1),H.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(r),t.appendChild(n),t.appendChild(i),t.appendChild(o),J){var s=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(ce(0,"isLocal"))&&l.setAttribute("checked","checked"),de(e,s),H.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,de(e,s)}))}var u=document.getElementById("dg-new-constructor");H.bind(u,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||$.hide()})),H.bind(r,"click",(function(){u.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),$.show(),u.focus(),u.select()})),H.bind(n,"click",(function(){e.save()})),H.bind(i,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),H.bind(o,"click",(function(){e.revert()}))}function fe(e){var t=void 0;function r(r){return r.preventDefault(),e.width+=t-r.clientX,e.onResize(),t=r.clientX,!1}function n(){H.removeClass(e.__closeButton,ie.CLASS_DRAG),H.unbind(window,"mousemove",r),H.unbind(window,"mouseup",n)}function i(i){return i.preventDefault(),t=i.clientX,H.addClass(e.__closeButton,ie.CLASS_DRAG),H.bind(window,"mousemove",r),H.bind(window,"mouseup",n),!1}e.__resize_handle=document.createElement("div"),f.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),H.bind(e.__resize_handle,"mousedown",i),H.bind(e.__closeButton,"mousedown",i),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function me(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function ve(e,t){var r={};return f.each(e.__rememberedObjects,(function(n,i){var o={},a=e.__rememberedObjectIndecesToControllers[i];f.each(a,(function(e,r){o[r]=t?e.initialValue:e.getValue()})),r[i]=o})),r}ie.toggleHide=function(){re=!re,f.each(ne,(function(e){e.domElement.style.display=re?"none":""}))},ie.CLASS_AUTO_PLACE="a",ie.CLASS_AUTO_PLACE_CONTAINER="ac",ie.CLASS_MAIN="main",ie.CLASS_CONTROLLER_ROW="cr",ie.CLASS_TOO_TALL="taller-than-window",ie.CLASS_CLOSED="closed",ie.CLASS_CLOSE_BUTTON="close-button",ie.CLASS_CLOSE_TOP="close-top",ie.CLASS_CLOSE_BOTTOM="close-bottom",ie.CLASS_DRAG="drag",ie.DEFAULT_WIDTH=245,ie.TEXT_CLOSED="Close Controls",ie.TEXT_OPEN="Open Controls",ie._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||ie.toggleHide()},H.bind(window,"keydown",ie._keydownHandler,!1),f.extend(ie.prototype,{add:function(e,t){return ue(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return ue(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;f.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&te.removeChild(this.domElement);var e=this;f.each(this.__folders,(function(t){e.removeFolder(t)})),H.unbind(window,"keydown",ie._keydownHandler,!1),ae(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new ie(t);this.__folders[e]=r;var n=oe(this,r.domElement);return H.addClass(n,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],ae(e);var t=this;f.each(e.__folders,(function(t){e.removeFolder(t)})),f.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=H.getOffset(e.__ul).top,r=0;f.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(r+=H.getHeight(t))})),window.innerHeight-t-20<r?(H.addClass(e.domElement,ie.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(H.removeClass(e.domElement,ie.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&f.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:f.debounce((function(){this.onResize()}),50),remember:function(){if(f.isUndefined($)&&(($=new q).domElement.innerHTML=Z),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;f.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&pe(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&me(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ve(this)),e.folders={},f.each(this.__folders,(function(t,r){e.folders[r]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ve(this),se(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=ve(this,!0)),this.load.remembered[e]=ve(this),this.preset=e,he(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){f.each(this.__controllers,(function(t){this.getRoot().load.remembered?le(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),f.each(this.__folders,(function(e){e.revert(e)})),e||se(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&Q.call(window,(function(){e(t)}));f.each(t,(function(e){e.updateDisplay()}))}(this.__listening)},updateDisplay:function(){f.each(this.__controllers,(function(e){e.updateDisplay()})),f.each(this.__folders,(function(e){e.updateDisplay()}))}});function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=we(e);if(t){var i=we(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ye(this,r)}}function ye(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}for(var Ee=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(r,e);var t=be(r);function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=t.call(this)).controller={},e.lineController={},e}return r}(ie)),Te=[],xe=0;xe<256;xe++)Te[xe]=(xe<16?"0":"")+xe.toString(16);var Re={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Te[255&e]+Te[e>>8&255]+Te[e>>16&255]+Te[e>>24&255]+"-"+Te[255&t]+Te[t>>8&255]+"-"+Te[t>>16&15|64]+Te[t>>24&255]+"-"+Te[63&r|128]+Te[r>>8&255]+"-"+Te[r>>16&255]+Te[r>>24&255]+Te[255&n]+Te[n>>8&255]+Te[n>>16&255]+Te[n>>24&255]).toUpperCase()},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Re.DEG2RAD},radToDeg:function(e){return e*Re.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,n,i){var o=Math.cos,a=Math.sin,s=o(r/2),l=a(r/2),u=o((t+n)/2),c=a((t+n)/2),h=o((t-n)/2),d=a((t-n)/2),p=o((n-t)/2),f=a((n-t)/2);"XYX"===i?e.set(s*c,l*h,l*d,s*u):"YZY"===i?e.set(l*d,s*c,l*h,s*u):"ZXZ"===i?e.set(l*h,l*d,s*c,s*u):"XZX"===i?e.set(s*c,l*f,l*p,s*u):"YXY"===i?e.set(l*p,s*c,l*f,s*u):"ZYZ"===i?e.set(l*f,l*p,s*c,s*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}THREE.MathUtils=Re,THREE.GLTFLoader=function(){function e(e){THREE.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:e,load:function(e,t,r,n){var i,o=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),o.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new THREE.FileLoader(o.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(r){try{o.parse(r,i,(function(r){t(r),o.manager.itemEnd(e)}),a)}catch(e){a(e)}}),r,a)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,s,l){var d,m={};if("string"==typeof e)d=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===a){try{m[r.KHR_BINARY_GLTF]=new u(e)}catch(e){return void(l&&l(e))}d=m[r.KHR_BINARY_GLTF].content}else d=THREE.LoaderUtils.decodeText(new Uint8Array(e));var v=JSON.parse(d);if(void 0===v.asset||v.asset.version[0]<2)l&&l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(v.extensionsUsed)for(var g=0;g<v.extensionsUsed.length;++g){var _=v.extensionsUsed[g],b=v.extensionsRequired||[];switch(_){case r.KHR_LIGHTS_PUNCTUAL:m[_]=new i(v);break;case r.KHR_MATERIALS_UNLIT:m[_]=new o;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[_]=new p;break;case r.KHR_DRACO_MESH_COMPRESSION:m[_]=new c(v,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:m[_]=new n(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:m[_]=new h;break;case r.KHR_MESH_QUANTIZATION:m[_]=new f;break;default:b.indexOf(_)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}new F(v,m,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(s,l)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function i(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function o(){this.name=r.KHR_MATERIALS_UNLIT}i.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new THREE.Color(16777215);void 0!==r.color&&n.fromArray(r.color);var i=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new THREE.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(n)).distance=i;break;case"spot":(t=new THREE.SpotLight(n)).distance=i,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},o.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},o.prototype.extendParams=function(e,t,r){var n=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(n)};var a="glTF",s=1313821514,l=5130562;function u(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(e,12),i=0;i<n.byteLength;){var o=n.getUint32(i,!0);i+=4;var u=n.getUint32(i,!0);if(i+=4,u===s){var c=new Uint8Array(e,12+i,o);this.content=THREE.LoaderUtils.decodeText(c)}else if(u===l){var h=12+i;this.body=e.slice(h,h+o)}i+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function c(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function h(){this.name=r.KHR_TEXTURE_TRANSFORM}function d(e){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),a={specular:{value:(new THREE.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(var s in a)e.uniforms[s]=a[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function p(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=[];if(Array.isArray(n.diffuseFactor)){var o=n.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==n.diffuseTexture&&i.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var a=n.specularGlossinessTexture;i.push(r.assignTexture(e,"glossinessMap",a)),i.push(r.assignTexture(e,"specularMap",a))}return Promise.all(i)},createMaterial:function(e){var t=new d(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=THREE.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function f(){this.name=r.KHR_MESH_QUANTIZATION}function m(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)}c.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},l={};for(var u in o){var c=A[u]||u.toLowerCase();a[c]=o[u]}for(u in e.attributes){c=A[u]||u.toLowerCase();if(void 0!==o[u]){var h=r.accessors[e.attributes[u]],d=T[h.componentType];l[c]=d,s[c]=!0===h.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)}),a,l)}))}))},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},d.prototype=Object.create(THREE.MeshStandardMaterial.prototype),d.prototype.constructor=d,d.prototype.copy=function(e){return THREE.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},m.prototype=Object.create(THREE.Interpolant.prototype),m.prototype.constructor=m,m.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,o=0;o!==n;o++)t[o]=r[i+o];return t},m.prototype.beforeStart_=m.prototype.copySampleValue_,m.prototype.afterEnd_=m.prototype.copySampleValue_,m.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,u=n-t,c=(r-t)/u,h=c*c,d=h*c,p=e*l,f=p-l,m=-2*d+3*h,v=d-h,g=1-m,_=v-h+c,b=0;b!==a;b++){var y=o[f+b+a],w=o[f+b+s]*u,E=o[p+b+a],T=o[p+b]*u;i[b]=g*y+_*w+m*E+v*T}return i};var v=0,g=1,_=2,b=3,y=4,w=5,E=6,T={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},x={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},R={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},S={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},k={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},M="OPAQUE",L="MASK",O="BLEND",P={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function H(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function D(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function I(e,t){void 0!==t.extras&&("object"===Se(t.extras)?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function B(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function N(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function F(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function z(e,t,r){var n=t.attributes,i=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var a in n){var s=A[a]||a.toLowerCase();s in e.attributes||i.push(o(n[a],s))}if(void 0!==t.indices&&!e.index){var l=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(l)}return I(e,t),function(e,t,r){var n=t.attributes,i=new THREE.Box3;if(void 0!==n.POSITION){var o=(d=r.json.accessors[n.POSITION]).min,a=d.max;if(void 0!==o&&void 0!==a){i.set(new THREE.Vector3(o[0],o[1],o[2]),new THREE.Vector3(a[0],a[1],a[2]));var s=t.targets;if(void 0!==s)for(var l=new THREE.Vector3,u=0,c=s.length;u<c;u++){var h=s[u];if(void 0!==h.POSITION){var d;o=(d=r.json.accessors[h.POSITION]).min,a=d.max;void 0!==o&&void 0!==a?(l.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),l.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),l.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),i.expandByVector(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}e.boundingBox=i;var p=new THREE.Sphere;i.getCenter(p.center),p.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=p}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,i=!1,o=0,a=t.length;o<a;o++){if(void 0!==(u=t[o]).POSITION&&(n=!0),void 0!==u.NORMAL&&(i=!0),n&&i)break}if(!n&&!i)return Promise.resolve(e);var s=[],l=[];for(o=0,a=t.length;o<a;o++){var u=t[o];if(n){var c=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;s.push(c)}if(i){c=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;l.push(c)}}return Promise.all([Promise.all(s),Promise.all(l)]).then((function(t){var r=t[0],o=t[1];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function U(e,t){var r=e.getIndex();if(null===r){var n=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var o=0;o<i.count;o++)n.push(o);e.setIndex(n),r=e.getIndex()}var a=r.count-2,s=[];if(t===THREE.TriangleFanDrawMode)for(o=1;o<=a;o++)s.push(r.getX(0)),s.push(r.getX(o)),s.push(r.getX(o+1));else for(o=0;o<a;o++)o%2==0?(s.push(r.getX(o)),s.push(r.getX(o+1)),s.push(r.getX(o+2))):(s.push(r.getX(o+2)),s.push(r.getX(o+1)),s.push(r.getX(o)));s.length/3!==a&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(s),l}return F.prototype.parse=function(e,t){var r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};D(i,o,n),I(o,n),e(o)})).catch(t)},F.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},i={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,l=0,u=s.length;l<u;l++)e[s[l]].isBone=!0;for(var c=0,h=e.length;c<h;c++){var d=e[c];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=i[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=i},F.prototype.getDependency=function(e,t){var n=e+":"+t,i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i},F.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},F.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,r){n.load(H(t.uri,i.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},F.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},F.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,o,a=e[0],s=S[n.type],l=T[n.componentType],u=l.BYTES_PER_ELEMENT,c=u*s,h=n.byteOffset||0,d=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,p=!0===n.normalized;if(d&&d!==c){var f=Math.floor(h/d),m="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+f+":"+n.count,v=t.cache.get(m);v||(i=new l(a,f*d,n.count*d/u),v=new THREE.InterleavedBuffer(i,d/u),t.cache.add(m,v)),o=new THREE.InterleavedBufferAttribute(v,s,h%d/u,p)}else i=null===a?new l(n.count*s):new l(a,h,n.count*s),o=new THREE.BufferAttribute(i,s,p);if(void 0!==n.sparse){var g=S.SCALAR,_=T[n.sparse.indices.componentType],b=n.sparse.indices.byteOffset||0,y=n.sparse.values.byteOffset||0,w=new _(e[1],b,n.sparse.count*g),E=new l(e[2],y,n.sparse.count*s);null!==a&&(o=new THREE.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var x=0,R=w.length;x<R;x++){var A=w[x];if(o.setX(A,E[x*s]),s>=2&&o.setY(A,E[x*s+1]),s>=3&&o.setZ(A,E[x*s+2]),s>=4&&o.setW(A,E[x*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},F.prototype.loadTexture=function(e){var t,n=this,i=this.json,o=this.options,a=this.textureLoader,s=window.URL||window.webkitURL,l=i.textures[e],u=l.extensions||{},c=(t=u[r.MSFT_TEXTURE_DDS]?i.images[u[r.MSFT_TEXTURE_DDS].source]:i.images[l.source]).uri,h=!1;return void 0!==t.bufferView&&(c=n.getDependency("bufferView",t.bufferView).then((function(e){h=!0;var r=new Blob([e],{type:t.mimeType});return c=s.createObjectURL(r)}))),Promise.resolve(c).then((function(e){var t=o.manager.getHandler(e);return t||(t=u[r.MSFT_TEXTURE_DDS]?n.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise((function(r,n){t.load(H(e,o.path),r,void 0,n)}))})).then((function(e){!0===h&&s.revokeObjectURL(c),e.flipY=!1,void 0!==l.name&&(e.name=l.name),t.mimeType in P&&(e.format=P[t.mimeType]);var r=(i.samplers||{})[l.sampler]||{};return e.magFilter=x[r.magFilter]||THREE.LinearFilter,e.minFilter=x[r.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=R[r.wrapS]||THREE.RepeatWrapping,e.wrapT=R[r.wrapT]||THREE.RepeatWrapping,e}))},F.prototype.assignTexture=function(e,t,n){var i=this;return this.getDependency("texture",n.index).then((function(o){if(!o.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":o.format=THREE.RGBFormat}if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[r.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;a&&(o=i.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(o,a))}e[t]=o}))},F.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=(this.extensions,void 0!==t.attributes.tangent),i=void 0!==t.attributes.color,o=void 0===t.attributes.normal,a=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,l=s&&void 0!==t.morphAttributes.normal;if(e.isPoints){var u="PointsMaterial:"+r.uuid,c=this.cache.get(u);c||(c=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,c.sizeAttenuation=!1,this.cache.add(u,c)),r=c}else if(e.isLine){u="LineBasicMaterial:"+r.uuid;var h=this.cache.get(u);h||(h=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(h,r),h.color.copy(r.color),this.cache.add(u,h)),r=h}if(n||i||o||a||s){u="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),a&&(u+="skinning:"),n&&(u+="vertex-tangents:"),i&&(u+="vertex-colors:"),o&&(u+="flat-shading:"),s&&(u+="morph-targets:"),l&&(u+="morph-normals:");var d=this.cache.get(u);d||(d=r.clone(),a&&(d.skinning=!0),n&&(d.vertexTangents=!0),i&&(d.vertexColors=THREE.VertexColors),o&&(d.flatShading=!0),s&&(d.morphTargets=!0),l&&(d.morphNormals=!0),this.cache.add(u,d)),r=d}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new THREE.BufferAttribute(t.attributes.uv.array,2)),r.normalScale&&!n&&(r.normalScale.y=-r.normalScale.y),e.material=r},F.prototype.loadMaterial=function(e){var t,n=this.json,i=this.extensions,o=n.materials[e],a={},s=o.extensions||{},l=[];if(s[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(),l.push(u.extendParams(a,o,this))}else if(s[r.KHR_MATERIALS_UNLIT]){var c=i[r.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),l.push(c.extendParams(a,o,this))}else{t=THREE.MeshStandardMaterial;var h=o.pbrMetallicRoughness||{};if(a.color=new THREE.Color(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){var p=h.baseColorFactor;a.color.fromArray(p),a.opacity=p[3]}void 0!==h.baseColorTexture&&l.push(this.assignTexture(a,"map",h.baseColorTexture)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(l.push(this.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),l.push(this.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture)))}!0===o.doubleSided&&(a.side=THREE.DoubleSide);var f=o.alphaMode||M;return f===O?a.transparent=!0:(a.transparent=!1,f===L&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new THREE.Vector2(1,1),void 0!==o.normalTexture.scale&&a.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(a.emissive=(new THREE.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==THREE.MeshBasicMaterial&&l.push(this.assignTexture(a,"emissiveMap",o.emissiveTexture)),Promise.all(l).then((function(){var e;return e=t===d?i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new t(a),void 0!==o.name&&(e.name=o.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),I(e,o),o.extensions&&D(i,e,o),e}))},F.prototype.loadGeometries=function(e){var t=this,n=this.extensions,i=this.primitiveCache;function o(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return z(r,e,t)}))}for(var a,s,l=[],u=0,c=e.length;u<c;u++){var h,d=e[u],p=(s=void 0,(s=(a=d).extensions&&a.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+N(s.attributes):a.indices+":"+N(a.attributes)+":"+a.mode),f=i[p];if(f)l.push(f.promise);else h=d.extensions&&d.extensions[r.KHR_DRACO_MESH_COMPRESSION]?o(d):z(new THREE.BufferGeometry,d,t),i[p]={primitive:d,promise:h},l.push(h)}return Promise.all(l)},F.prototype.loadMesh=function(e){for(var t,r=this,n=this.json.meshes[e],i=n.primitives,o=[],a=0,s=i.length;a<s;a++){var l=void 0===i[a].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),t.DefaultMaterial):this.getDependency("material",i[a].material);o.push(l)}return o.push(r.loadGeometries(i)),Promise.all(o).then((function(t){for(var o=t.slice(0,t.length-1),a=t[t.length-1],s=[],l=0,u=a.length;l<u;l++){var c,h=a[l],d=i[l],p=o[l];if(d.mode===y||d.mode===w||d.mode===E||void 0===d.mode)!0!==(c=!0===n.isSkinnedMesh?new THREE.SkinnedMesh(h,p):new THREE.Mesh(h,p)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),d.mode===w?c.geometry=U(c.geometry,THREE.TriangleStripDrawMode):d.mode===E&&(c.geometry=U(c.geometry,THREE.TriangleFanDrawMode));else if(d.mode===g)c=new THREE.LineSegments(h,p);else if(d.mode===b)c=new THREE.Line(h,p);else if(d.mode===_)c=new THREE.LineLoop(h,p);else{if(d.mode!==v)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);c=new THREE.Points(h,p)}Object.keys(c.geometry.morphAttributes).length>0&&B(c,n),c.name=n.name||"mesh_"+e,a.length>1&&(c.name+="_"+l),I(c,n),r.assignFinalMaterial(c),s.push(c)}if(1===s.length)return s[0];var f=new THREE.Group;for(l=0,u=s.length;l<u;l++)f.add(s[l]);return f}))},F.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new THREE.OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),I(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},F.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},F.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],i=[],o=[],a=[],s=0,l=t.channels.length;s<l;s++){var u=t.channels[s],c=t.samplers[u.sampler],h=u.target,d=void 0!==h.node?h.node:h.id,p=void 0!==t.parameters?t.parameters[c.input]:c.input,f=void 0!==t.parameters?t.parameters[c.output]:c.output;r.push(this.getDependency("node",d)),n.push(this.getDependency("accessor",p)),i.push(this.getDependency("accessor",f)),o.push(c),a.push(h)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(i),Promise.all(o),Promise.all(a)]).then((function(r){for(var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=[],u=0,c=n.length;u<c;u++){var h=n[u],d=i[u],p=o[u],f=a[u],v=s[u];if(void 0!==h){var g;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,k[v.path]){case k.weights:g=THREE.NumberKeyframeTrack;break;case k.rotation:g=THREE.QuaternionKeyframeTrack;break;case k.position:case k.scale:default:g=THREE.VectorKeyframeTrack}var _=h.name?h.name:h.uuid,b=void 0!==f.interpolation?C[f.interpolation]:THREE.InterpolateLinear,y=[];k[v.path]===k.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&y.push(e.name?e.name:e.uuid)})):y.push(_);var w=p.array;if(p.normalized){var E;if(w.constructor===Int8Array)E=1/127;else if(w.constructor===Uint8Array)E=1/255;else if(w.constructor==Int16Array)E=1/32767;else{if(w.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");E=1/65535}for(var T=new Float32Array(w.length),x=0,R=w.length;x<R;x++)T[x]=w[x]*E;w=T}for(x=0,R=y.length;x<R;x++){var S=new g(y[x]+"."+k[v.path],d.array,w,b);"CUBICSPLINE"===f.interpolation&&(S.createInterpolant=function(e){return new m(this.times,this.values,this.getValueSize()/3,e)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(S)}}}var A=void 0!==t.name?t.name:"animation_"+e;return new THREE.AnimationClip(A,void 0,l)}))},F.prototype.loadNode=function(e){var t,n=this.json,i=this.extensions,o=this,a=n.meshReferences,s=n.meshUses,l=n.nodes[e];return(t=[],void 0!==l.mesh&&t.push(o.getDependency("mesh",l.mesh).then((function(e){var t;if(a[l.mesh]>1){var r=s[l.mesh]++;(t=e.clone()).name+="_instance_"+r}else t=e;return void 0!==l.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=l.weights.length;t<r;t++)e.morphTargetInfluences[t]=l.weights[t]})),t}))),void 0!==l.camera&&t.push(o.getDependency("camera",l.camera)),l.extensions&&l.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&t.push(o.getDependency("light",l.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===l.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var r=0,n=e.length;r<n;r++)t.add(e[r]);if(void 0!==l.name&&(t.userData.name=l.name,t.name=THREE.PropertyBinding.sanitizeNodeName(l.name)),I(t,l),l.extensions&&D(i,t,l),void 0!==l.matrix){var o=new THREE.Matrix4;o.fromArray(l.matrix),t.applyMatrix4(o)}else void 0!==l.translation&&t.position.fromArray(l.translation),void 0!==l.rotation&&t.quaternion.fromArray(l.rotation),void 0!==l.scale&&t.scale.fromArray(l.scale);return t}))},F.prototype.loadScene=function(){function e(t,r,n,i){var o=n.nodes[t];return i.getDependency("node",t).then((function(e){return void 0===o.skin?e:i.getDependency("skin",o.skin).then((function(e){for(var r=[],n=0,o=(t=e).joints.length;n<o;n++)r.push(i.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],i=[],o=0,a=r.length;o<a;o++){var s=r[o];if(s){n.push(s);var l=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*o),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new THREE.Skeleton(n,i),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var a=[];if(o.children)for(var s=o.children,l=0,u=s.length;l<u;l++){var c=s[l];a.push(e(c,t,n,i))}return Promise.all(a)}))}return function(t){var r=this.json,n=this.extensions,i=this.json.scenes[t],o=new THREE.Scene;void 0!==i.name&&(o.name=i.name),I(o,i),i.extensions&&D(n,o,i);for(var a=i.nodes||[],s=[],l=0,u=a.length;l<u;l++)s.push(e(a[l],o,r,this));return Promise.all(s).then((function(){return o}))}}(),e}();r(35);var Ae=r(13),ke=r.n(Ae);function Ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me=window.THREE,Le=new(function(){function e(){var t,r,n,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n],a=o.name,s=o.fbx,l=o.gltf,u=o.texture,c=o.img;i.subjects[a]={},s&&r.push(i.loadFBX(s,a)),l&&r.push(i.loadGLTF(l,a)),u&&r.push(i.loadTexture(u,a)),c&&r.push(i.loadImage(c,a))}Promise.all(r).then(t)},(r="load")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,this.subjects={},this.textureLoader=new Me.TextureLoader,this.FBXLoader=new ke.a,this.GLTFLoader=new Me.GLTFLoader,this.DRACOLoader=new Me.DRACOLoader}var t,r,n;return t=e,(r=[{key:"loadFBX",value:function(e,t){var r=this;return new Promise((function(n){r.FBXLoader.load(e,(function(e){r.subjects[t].fbx=e,n(e)}),void 0,(function(e){console.log(e)}))}))}},{key:"loadGLTF",value:function(e,t){var r=this;return new Promise((function(n){r.DRACOLoader.setDecoderPath("../scene/vendor/three/draco/"),r.GLTFLoader.setDRACOLoader(r.DRACOLoader),r.GLTFLoader.load(e,(function(e){r.subjects[t].gltf=e,n(e)}),void 0,(function(e){console.log(e)}))}))}},{key:"loadTexture",value:function(e,t){var r=this;return new Promise((function(n){r.textureLoader.load(e,(function(e){r.subjects[t].texture=e,n(e)}))}))}},{key:"loadImage",value:function(e,t){var r=this;return new Promise((function(n){var i=new Image;i.onload=function(){r.subjects[t].img=i,n(i)},i.src=e}))}}])&&Ce(t.prototype,r),n&&Ce(t,n),e}());function Oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pe=window.THREE,He=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentModel="tree",this.mouse={x:0,y:0},this.init(t,r)}var t,r,n;return t=e,(r=[{key:"init",value:function(e,t){this.scene=e,this.camera=t,this.guiController={tree_color:i.tree};var r=Le.subjects.scene.gltf;this.tree=r.scene.getObjectByName("GEO"),this.tree.material=new Pe.MeshBasicMaterial,this.tree.material.color.setHex(this.guiController.tree_color),this.scene.add(this.tree)}},{key:"events",value:function(){window.addEventListener(MOUSE_MOVE,this.handleMouseMove)}},{key:"render",value:function(e){this.now=e}}])&&Oe(t.prototype,r),n&&Oe(t,n),e}();function De(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Ie(e,t){return Math.random()*(t-e)+e}function Be(e,t,r){return Math.min(Math.max(e,t),r)}function Ne(e){return e*Math.PI/180}function Fe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=r-t,a=o/2+t;return Math.sin(e*n+i)*o/2+a}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ue=window.THREE,je=new Ue.PointsMaterial({color:16777215,size:14.5,depthWrite:!1,depthTest:!0,sizeAttenuation:!0,transparent:!0,opacity:.9}),Ve=function(){function e(t){var r,n,i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=function(){je.color.setHex(o.guiController.particles_color_bkg)},(n="guiChange")in(r=this)?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,this.nbParticles=500,this.range=1e3,this.opacity=0,this.guiController={particles_color_bkg:16777215},this.scene=t;var a=Le.subjects.particle_2.texture;je.map=a,je.color.setHex(this.guiController.particles_color_bkg);for(var s=new Ue.Geometry,l=this.range,u=0;u<this.nbParticles;u++){var c=new Ue.Vector3(Ie(-l,l),Ie(-l,l),Ie(-l,l));c.speed=Ie(.01,.2),c.velocityStep=Ie(1e-5,5e-5),c.velocity=0,s.vertices.push(c)}this.geometry=s,this.particlesLevitate=new Ue.Points(this.geometry,je),this.scene.add(this.particlesLevitate),this.initGUI()}var t,r,n;return t=e,(r=[{key:"initGUI",value:function(){Ee.addColor(this.guiController,"particles_color_bkg").name("ptcl bkg").onChange(this.guiChange)}},{key:"render",value:function(e){if(this.geometry){for(var t=0;t<this.geometry.vertices.length;t++){var r=this.geometry.vertices[t];r.velocity+=r.velocityStep,r.y+=r.speed+r.velocity,r.x+=r.speed/5+r.velocity/2,r.y>this.range&&(r.y=-this.range,r.velocity=0),r.x>this.range&&(r.x=-this.range,r.velocity=0)}this.geometry.verticesNeedUpdate=!0,this.opacity=Fe(e,.3,1,8e-4),je.opacity=this.opacity}}}])&&ze(t.prototype,r),n&&ze(t,n),e}(),Ge=r(1);function Xe(){return performance.now()}function Ye(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ze=window.THREE,Ke=[new Ze.Color(i.lines2),new Ze.Color(i.lines3),new Ze.Color(i.lines4)],Qe=[new Ze.PointsMaterial({color:Ke[0],size:8,depthWrite:!1,depthTest:!0,transparent:!0}),new Ze.PointsMaterial({color:Ke[1],size:8,depthWrite:!1,depthTest:!0,transparent:!0}),new Ze.PointsMaterial({color:Ke[2],size:8,depthWrite:!1,depthTest:!0,transparent:!0})],qe=new Ze.Geometry;qe.vertices.push(new Ze.Vector3(0,0,0));var Je=new Ze.Vector2(window.innerWidth,window.innerHeight),$e=[new Ge.MeshLineMaterial({color:Ke[0],resolution:Je,sizeAttenuation:!0,lineWidth:1,depthWrite:!1,depthTest:!0,transparent:!0,opacity:1,blending:Ze.AdditiveBlending}),new Ge.MeshLineMaterial({color:Ke[1],resolution:Je,sizeAttenuation:!0,lineWidth:1,depthWrite:!1,depthTest:!0,transparent:!0,opacity:1,blending:Ze.AdditiveBlending}),new Ge.MeshLineMaterial({color:Ke[2],resolution:Je,sizeAttenuation:!0,lineWidth:1,depthWrite:!1,depthTest:!0,transparent:!0,opacity:1,blending:Ze.AdditiveBlending})],et=function(){function e(t,r,n){var o,a,s,l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=function(){return new Promise((function(e){l.resolveAnimation=e}))},(a="animationDone")in(o=this)?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,this.scene=t,this.camera=r,this.progress=0,this.style=De(0,2),this.lineWidthMin=.5,this.lineWidthMax=1.5,this.lineSinFq=6,this.nbPoints=De(30,150),this.duration=8e3+22*this.nbPoints,this.progress=0,this.pointMaterial=Qe[this.style],this.pointMaterial.map=Le.subjects.particle_1.texture,this.lineThickness=1,this.lineThicknessMax=2.5,this.object=new Ze.Object3D,this.color=new Ze.Color(i.lines2),this.trail=this.createSpline(n.children),this.createPoint(),this.object.layers.enable(1),this.object.rotation.copy(n.rotation),this.object.position.copy(n.position),this.resetLinePosition()}var t,r,n;return t=e,(r=[{key:"createSpline",value:function(e){var t=this,r=e,n=[];r.sort((function(e,t){return parseInt(e.name,10)-parseInt(t.name,10)}));for(var i=0;i<r.length;i++)if("Mesh"===r[i].type){var o={x:r[i].position.x,y:r[i].position.y,z:r[i].position.z};0!==i&&i!==r.length-1&&i!==r.length-2&&(i%2==0?(o.x+=De(-7,7),o.y+=De(-7,7),o.z+=De(-7,7)):(o.x+=De(-2,2),o.y+=De(-2,2),o.z+=De(-2,2))),n.push(o)}var a=new Ze.CatmullRomCurve3(n);a.curveType="catmullrom",a.tension=.6;var s=a.getPoints(this.nbPoints);this.trail_geometry=new Ze.Geometry;for(var l=0;l<this.nbPoints;l++)this.trail_geometry.vertices.push(new Ze.Vector3);this.lineTrail=new Ge.MeshLine,this.lineTrail.setGeometry(this.trail_geometry,(function(e){return Fe(e,t.lineWidthMin,t.lineWidthMax,t.lineSinFq,300)}));var u=this.lineTrail.geometry,c=new Ze.Mesh(u,$e[this.style]);return this.lineMesh=c,this.lineMesh.layers.enable(1),this.lineMesh.frustumCulled=!1,this.object.add(c),new Ze.CatmullRomCurve3(s)}},{key:"createPoint",value:function(){this.point=new Ze.Points(qe,this.pointMaterial),this.point.position.copy(this.trail.getPoint(0).add(this.lineMesh.position)),this.object.add(this.point)}},{key:"resetLinePosition",value:function(){for(var e=this.lineMesh.geometry.attributes.position,t=this.trail.getPoint(0),r=0;r<e.count;r++)e.setXYZ(r,t.x,t.y,t.z),e.needsUpdate=!0}},{key:"start",value:function(){this.started=!0,this.isAnimationDone=!1,this.startAnimation=Xe()}},{key:"render",value:function(e){if(this.now=e,this.started){var t=this.lineMesh.material.uniforms.lineWidth,r=(this.now-this.startAnimation)/this.duration;r<1.1?(this.progress=1*Ye(r),this.lineTrail.advance(this.trail.getPoint(this.progress)),r>1&&(this.pointMaterial.visible=!1)):(this.resetLinePosition(),this.progress=0,this.isAnimationDone||(this.resolveAnimation(),this.isAnimationDone=!0,this.pointMaterial.visible=!0)),this.camera.parent?(t.value=Be(this.lineThickness*this.camera.parent.position.z/200,this.lineThickness,this.lineThicknessMax),this.point.material.size=Be(8*this.camera.parent.position.z/200,8,18)):t.value=this.lineThickness;var n=this.lineMesh.geometry.attributes.position;this.point.position.x=n.getX(n.count-1),this.point.position.y=n.getY(n.count-1),this.point.position.z=n.getZ(n.count-1)}}}])&&We(t.prototype,r),n&&We(t,n),e}();function tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var rt=window.THREE,nt=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.camera=r,this.points=n,this.splines=[],this.flowers=[],this.nbSplines=10,this.object=new rt.Object3D,this.initSplines()}var t,r,n;return t=e,(r=[{key:"initSplines",value:function(){for(var e=0;e<this.nbSplines;e++){var t=new et(this.scene,this.camera,this.points);this.splines.push(t),this.object.add(t.object)}}},{key:"render",value:function(e){if(this.now=e,this.splines.length>0)for(var t=0;t<this.splines.length;t++)this.splines[t].render(e)}}])&&tt(t.prototype,r),n&&tt(t,n),e}();function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ot=function(){function e(t,r){var n,o,a,s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=function(){for(var e=0;e<s.branches.length;e++)for(var t=s.branches[e],r=0;r<t.splines.length;r++){var n=t.splines[r];n.pointMaterial.color.setHex(s.guiController.splines_color),n.lineMesh.material.uniforms.color.value=new THREE.Color(s.guiController.splines_color)}},(o="guiChange")in(n=this)?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,this.scene=t,this.camera=r,this.branches=[],this.getSplinesPoints(),this.initBranches(),this.startAllAnimations(),this.guiController={splines_color:i.lines2},Ee.addColor(this.guiController,"splines_color").onChange(this.guiChange)}var t,r,n;return t=e,(r=[{key:"getSplinesPoints",value:function(){var e=Le.subjects.scene.gltf;this.splinesPoints=[e.scene.getObjectByName("spline_1"),e.scene.getObjectByName("spline_2"),e.scene.getObjectByName("spline_3"),e.scene.getObjectByName("spline_4"),e.scene.getObjectByName("spline_5"),e.scene.getObjectByName("spline_6"),e.scene.getObjectByName("spline_7"),e.scene.getObjectByName("spline_8")]}},{key:"initBranches",value:function(){for(var e=0;e<this.splinesPoints.length;e++){var t=this.splinesPoints[e];0===e?(t.children[1].position.y+=30,t.children[2].position.y+=22,t.children[3].position.y+=20,t.children[4].position.y+=20,t.children[5].position.y+=20,t.children[6].position.y+=10,t.children[7].position.y-=20,t.children[8].position.y-=20,t.children[9].position.y-=10,t.children[9].position.z-=2):1===e?(t.children[1].position.y+=22,t.children[2].position.y+=22,t.children[3].position.y+=20,t.children[4].position.y+=20,t.children[5].position.y+=20,t.children[6].position.y+=10,t.children[7].position.y-=20,t.children[8].position.y-=20,t.children[9].position.y-=10,t.children[9].position.z-=2):2===e?(t.children[1].position.y-=15,t.children[2].position.y-=15,t.children[3].position.y-=15,t.children[4].position.y-=10,t.children[5].position.y-=5,t.children[8].position.x+=10,t.children[9].position.x+=10,t.children[10].position.x+=10):3===e?(t.children[1].position.z-=15,t.children[2].position.z-=15,t.children[3].position.z-=15,t.children[4].position.z-=15,t.children[5].position.z-=5,t.children[6].position.y-=10,t.children[7].position.y-=10,t.children[8].position.y-=10,t.children[9].position.y-=10):4===e?(t.children[0].position.y+=20,t.children[1].position.y+=20,t.children[2].position.y+=20,t.children[3].position.y+=20,t.children[4].position.y+=10):5===e?(t.children[3].position.y+=10,t.children[4].position.y+=15,t.children[5].position.y+=10):6===e?(t.children[3].position.z+=10,t.children[4].position.z+=15,t.children[5].position.z+=10,t.children[7].position.z+=10,t.children[8].position.z+=10):7===e&&(t.children[0].position.z-=25,t.children[6].position.z+=10,t.children[7].position.z+=10,t.children[8].position.z+=10);var r=new nt(this.scene,this.camera,t);this.branches.push(r),this.scene.add(r.object)}}},{key:"startAllAnimations",value:function(){for(var e=this,t=[],r=0;r<this.branches.length;r++)for(var n=this.branches[r],i=function(e){var r=n.splines[e];t.push(r.animationDone());var i=De(0,2e3);setTimeout((function(){r.start()}),i)},o=0;o<n.splines.length;o++)i(o);Promise.all(t).then((function(){e.startAllAnimations()}))}},{key:"render",value:function(e){for(var t=0;t<this.branches.length;t++)this.branches[t].render(e)}}])&&it(t.prototype,r),n&&it(t,n),e}(),at=window.THREE;function st(e,t){var r=new at.Ray;new at.Vector3;e.computeBoundingBox();for(var n=e.boundingBox,i=[],o=new at.Vector3(1,1,1).normalize(),a=0;a<t;a++){var s=l(n.min,n.max);i.push(s)}function l(t,n){var i=new at.Vector3(at.Math.randFloat(t.x,n.x),at.Math.randFloat(t.y,n.y),at.Math.randFloat(t.z,n.z));return function(t){r.set(t,o);for(var n=0,i=e.attributes.position,a=i.count/3,s=new at.Vector3,l=new at.Vector3,u=new at.Vector3,c=0;c<a;c++)s.fromBufferAttribute(i,3*c+0),l.fromBufferAttribute(i,3*c+1),u.fromBufferAttribute(i,3*c+2),r.intersectTriangle(s,l,u,!1,new at.Vector3(0,0,0))&&n++;return n%2==1}(i)?i:l(t,n)}return(new at.BufferGeometry).setFromPoints(i)}var lt=r(14),ut=r.n(lt),ct=r(15),ht=r.n(ct);function dt(){return"standalone"in navigator||(!!window.matchMedia("(pointer: coarse)").matches||!window.matchMedia("(pointer: fine)").matches&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch))}function pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var mt=window.THREE,vt=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ft(this,"handleMouseMove",(function(e){var r=e.detail,n=r.x,i=r.y;t.mouse.x=n,t.mouse.y=i;var o=t.progressPosition<t.allowRotateThreshold?t.rotateForceStep1X:t.rotateForceX,a=t.progressPosition<t.allowRotateThreshold?t.rotateForceStep1Y:t.rotateForceY;t.targetRotateX=-1*t.mouse.y*o+180,t.targetRotateY=t.mouse.x*a})),ft(this,"handleScroll",(function(e){var r=e.detail,n=r.scrollY/r.maxHeight;t.progressPositionTarget=n,t.progressPositionTarget<t.allowRotateThreshold?document.documentElement.classList.add("show-scroll-text"):document.documentElement.classList.remove("show-scroll-text")})),this.progressPosition=0,this.progressPositionTarget=0,this.progressLookIntroX=0,this.progressLookIntroY=0,this.progressLookIntroZ=0,this.mouse={x:0,y:0},this.rotateForceX=3.5,this.rotateForceY=3.5,this.rotateForceStep1X=2,this.rotateForceStep1Y=3,this.coefRotate=.035,this.coefMove=.08,this.allowRotateThreshold=.08,this.targetRotateX=180,this.targetRotateY=0,this.durationIntroPosition=8e3,this.durationIntroLook=8e3,history.scrollRestoration&&(history.scrollRestoration="manual")}var t,r,n;return t=e,(r=[{key:"init",value:function(e,t){this.cameraBox=new mt.Object3D,this.camera=e,this.scene=t,this.scene.add(this.camera);var r=Le.subjects.scene.gltf.scene.getObjectByName("CamerasPoints");this.trailPosition=this.createTrail(r),this.createLookAt(),this.trailLookAt=this.createLookAtTrail(this.lookPoints),this.introTrailPosition=this.createIntroTrail(),this.createLookIntro();var n=this.trailPosition.getPoint(0);this.cameraBox.position.copy(n),this.camera.rotation.x=Ne(180),this.cameraBox.add(this.camera),this.scene.add(this.cameraBox),this.events();var i=this.introTrailPosition.getPoint(0);this.cameraBox.position.copy(i),this.cameraBox.lookAt(this.lookIntroPoints[0]),this.camera.lookAt(this.lookIntroPoints[0]),this.startIntro()}},{key:"createLookAtTrail",value:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);var n=new mt.CatmullRomCurve3(t).getPoints(200);return new mt.CatmullRomCurve3(n)}},{key:"createTrail",value:function(e){var t=e.children,r=[],n=new mt.MeshBasicMaterial({color:16711680});e.visible=!1,this.scene.add(e),this.scene.updateMatrixWorld();for(var i=0;i<t.length;i++)if("Mesh"===t[i].type){var o=new mt.Vector3;o.setFromMatrixPosition(t[i].matrixWorld),r.push(o),t[i].material=n}r.reverse(),r[0].z-=600,r[1].y+=100;var a=new mt.CatmullRomCurve3(r).getPoints(200);return new mt.CatmullRomCurve3(a)}},{key:"createLookAt",value:function(){this.lookPoints=[new mt.Vector3(0,110,0),new mt.Vector3(0,66,0),new mt.Vector3(0,272,0),new mt.Vector3(0,-75,0),new mt.Vector3(0,-110,0),new mt.Vector3(0,280,0),new mt.Vector3(0,-58,0)]}},{key:"createIntroTrail",value:function(){var e=[new mt.Vector3(0,70,500),this.trailPosition.getPoint(0)],t=new mt.CatmullRomCurve3(e).getPoints(200),r=new mt.CatmullRomCurve3(t);return r.curveType="catmullrom",r.tension=.3,r}},{key:"createLookIntro",value:function(){this.lookIntroPoints=[new mt.Vector3(0,70,0),this.lookPoints[0]]}},{key:"events",value:function(){dt()||window.addEventListener("MOUSE_MOVE",this.handleMouseMove),window.addEventListener("SCROLL",this.handleScroll)}},{key:"startIntro",value:function(){this.startIntroAnimation=Xe(),this.introStarted=!0,this.introEnded=!1,this.originLookIntroX=this.lookIntroPoints[0].x,this.originLookIntroY=this.lookIntroPoints[0].y,this.originLookIntroZ=this.lookIntroPoints[0].z,this.targetLookIntro=this.lookIntroPoints[1]}},{key:"render",value:function(e){!this.introEnded&&this.introStarted&&this.animateIntro(e),this.introEnded&&this.scrollMoveCamera(),this.canMove&&this.mouseMoveCamera()}},{key:"mouseMoveCamera",value:function(){this.camera.rotation.x!==Ne(this.targetRotateX)&&(this.camera.rotation.x+=(Ne(this.targetRotateX)-this.camera.rotation.x)*this.coefRotate,this.camera.updateProjectionMatrix()),this.camera.rotation.y!==Ne(this.targetRotateY)&&(this.camera.rotation.y+=(Ne(this.targetRotateY)-this.camera.rotation.y)*this.coefRotate,this.camera.updateProjectionMatrix())}},{key:"scrollMoveCamera",value:function(){this.progressPosition+=(this.progressPositionTarget-this.progressPosition)*this.coefMove;var e=this.trailPosition.getPoint(this.progressPosition);this.cameraBox.position.copy(e);var t=this.trailLookAt.getPoint(this.progressPosition);this.cameraBox.lookAt(new mt.Vector3(t.x,t.y,0))}},{key:"animateIntro",value:function(e){var t=(e-this.startIntroAnimation)/this.durationIntroPosition;if(t<1){var r=Ye(t),n=this.introTrailPosition.getPoint(r);this.cameraBox.position.copy(n),t>.3&&(this.canMove=!0)}else this.introEnded=!0,document.documentElement.classList.add("scroll"),document.documentElement.classList.add("show-scroll-text");var i=(e-this.startIntroAnimation)/this.durationIntroLook;i=Math.max(i,0),this.progressLookIntroX=this.originLookIntroX+(this.targetLookIntro.x-this.originLookIntroX)*Ye(i),this.progressLookIntroY=this.originLookIntroY+(this.targetLookIntro.y-this.originLookIntroY)*Ye(i),this.progressLookIntroZ=this.originLookIntroZ+(this.targetLookIntro.z-this.originLookIntroZ)*Ye(i),this.cameraBox.lookAt(new mt.Vector3(this.progressLookIntroX,this.progressLookIntroY,0))}}])&&pt(t.prototype,r),n&&pt(t,n),e}());function gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var bt=window.THREE,yt=new bt.PointsMaterial({color:i.particles,sizeAttenuation:!0,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.4}),wt=new bt.PointsMaterial({color:i.particles,sizeAttenuation:!0,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.8}),Et=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_t(this,"handleMouseMove",(function(e){var t=e.detail,r=t.x,i=t.y;n.targetRotateX=-1*i*n.rotateForceX,n.targetRotateY=r*n.rotateForceY})),_t(this,"guiChange",(function(){yt.color.setHex(n.guiController.particles_color),wt.color.setHex(n.guiController.particles_color)})),this.scene=t,this.camera=r;var o,a,s,l=Le.subjects.leaves.fbx,u=Le.subjects.particle_1.texture;this.particleTexture=u,this.coefRotate=.035,this.rotateForceX=.8,this.rotateForceY=1,this.targetRotateX=0,this.targetRotateY=0,this.currentRotateX=this.currentRotateY=0,this.groupLeaves=[{object:l.children[1],material:yt,nbParticles:5e3,pointSize:2,pointSizeMin:1.8,pointSizeMax:4.5},{object:l.children[0],material:wt,nbParticles:250,pointSize:5,pointSizeMin:5,pointSizeMax:7}];for(var c=0;c<this.groupLeaves.length;c++){var h=this.groupLeaves[c],d=(o=h.object,a=void 0,s=void 0,a=new at.Vector3,(s=o.geometry).computeBoundingBox(),a.x=(s.boundingBox.max.x+s.boundingBox.min.x)/2,a.y=(s.boundingBox.max.y+s.boundingBox.min.y)/2,a.z=(s.boundingBox.max.z+s.boundingBox.min.z)/2,o.localToWorld(a),a);d.y=0,h.object.rotation.z+=bt.Math.degToRad(-2);var p=st(h.object.geometry,h.nbParticles);this.initMaterial(p,h),h.mesh=this.addMesh(p,h),h.center=d,h.originRotation=h.object.rotation.clone()}this.guiController={particles_color:i.particles},Ee.addColor(this.guiController,"particles_color").name("ptcl tree").onChange(this.guiChange),this.events()}var t,r,n;return t=e,(r=[{key:"events",value:function(){dt()||window.addEventListener("MOUSE_MOVE",this.handleMouseMove)}},{key:"initMaterial",value:function(e,t){var r=t.material,n=t.pointSize;r.map=this.particleTexture,r.size=n;for(var i=e.attributes.position.count,o=new Float32Array(i),a=new Float32Array(i),s=0;s<i;s++)o[s]=Ie(0,1e3),a[s]=Ie(.5,2);e.setAttribute("alphaOffset",new bt.BufferAttribute(o,1)),e.setAttribute("alphaSpeed",new bt.BufferAttribute(a,1)),r.userData.time={value:0},r.onBeforeCompile=function(e){e.uniforms.time=r.userData.time,e.vertexShader=ht.a,e.fragmentShader=ut.a}}},{key:"addMesh",value:function(e,t){var r=t.material,n=t.object,i=n.position,o=n.rotation,a=new bt.Points(e,r);return a.position.copy(i),a.rotation.copy(o),this.scene.add(a),a}},{key:"render",value:function(e){this.now=e,vt.progressPosition>vt.allowRotateThreshold+.1&&this.currentRotateY!==Ne(this.targetRotateY)&&this.currentRotateX!==Ne(this.targetRotateX)&&this.mouseMoveRotate();for(var t=0;t<this.groupLeaves.length;t++){var r=this.groupLeaves[t];r.material.userData.time.value=-e/10,this.camera.parent&&(r.material.size=Be(r.pointSize*this.camera.parent.position.z/200,r.pointSizeMin,r.pointSizeMax))}}},{key:"mouseMoveRotate",value:function(){var e;this.camera.parent&&((e=this.camera.parent.position.clone()).y=0);for(var t=0;t<this.groupLeaves.length;t++){var r=this.groupLeaves[t],n=r.mesh,i=r.center;this.currentRotateY+=(Ne(this.targetRotateY)-this.currentRotateY)*this.coefRotate,this.currentRotateX+=(Ne(this.targetRotateX)-this.currentRotateX)*this.coefRotate;var o=new bt.Vector3;o.subVectors(e,i).normalize(),o.applyAxisAngle(new bt.Vector3(0,1,0),Ne(90));var a=[{axis:o,angle:this.currentRotateX},{axis:new bt.Vector3(0,1,0),angle:this.currentRotateY}];this.rotateOnWorldAxis(n,a)}}},{key:"rotateOnWorldAxis",value:function(e,t){var r=new bt.Object3D;r.position.copy(e.position);for(var n=0;n<t.length;n++){var i=t[n],o=i.axis,a=i.angle;r.rotateOnWorldAxis(o,a)}e.rotation.copy(r.rotation),r.remove()}}])&&gt(t.prototype,r),n&&gt(t,n),e}(),Tt=r(16),xt=r.n(Tt),Rt=r(17),St=r.n(Rt);function At(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ct=window.THREE,Mt="img/assets-scene/",Lt=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),kt(this,"init",(function(){r.ui.loader.style.display="none",r.buildStats(),r.buildScene(),r.buildRender(),r.buildCamera(),r.initGUI(),r.bloom(),r.buildBackground(),r.branches=new ot(r.scene,r.camera),r.tree=new He(r.scene,r.camera),r.floatingParticles=new Ve(r.scene),r.leaves=new Et(r.scene,r.camera),window.dispatchEvent(n("START_SCENE")),r.events()})),kt(this,"guiChange",(function(){r.renderer.toneMappingExposure=Math.pow(r.guiController.exposure,4),r.bloomPass.threshold=Number(r.guiController.bloomThreshold),r.bloomPass.strength=Number(r.guiController.bloomStrength),r.bloomPass.radius=Number(r.guiController.bloomRadius),r.backgroundTexture.material.color.setHex(r.guiController.background)})),kt(this,"render",(function(e){var t=e.detail.now;r.stats.begin(),r.controls&&r.controls.update(),r.tree&&r.tree.render(t),r.floatingParticles&&r.floatingParticles.render(t),r.branches&&r.branches.render(t),r.leaves&&r.leaves.render(t),vt.render(t),r.moveBackground(),r.renderBloom(!0),r.finalComposer.render(),r.stats.end()})),kt(this,"darkenNonBloomed",(function(e){e.isMesh&&!1===r.bloomLayer.test(e.layers)&&(r.materials[e.uuid]=e.material,e.material=r.darkMaterial)})),kt(this,"restoreMaterial",(function(e){r.materials[e.uuid]&&(e.material=r.materials[e.uuid],delete r.materials[e.uuid])})),kt(this,"disposeMaterial",(function(e){e.material&&e.material.dispose()})),kt(this,"handleMouseMove",(function(e){var t=e.clientX/window.innerWidth*2-1,r=-e.clientY/window.innerHeight*2+1;window.dispatchEvent(n("MOUSE_MOVE",{x:t,y:r}))})),kt(this,"handleScroll",(function(){window.dispatchEvent(n("SCROLL",{scrollY:window.scrollY,maxHeight:r.maxHeight}))})),kt(this,"handleResize",(function(){r.setUnits(),r.camera.aspect=r.width/r.height,r.camera.updateProjectionMatrix(),r.setSizes(),r.bloomComposer&&r.bloomComposer.setSize(r.width,r.height),r.finalComposer&&r.finalComposer.setSize(r.width,r.height)})),this.canvas=t,this.scrollContainerEl=document.querySelector(".scroll-container"),this.setUnits(),this.ui={loader:document.querySelector(".scene__loader")},this.load()}var t,r,i;return t=e,(r=[{key:"load",value:function(){Le.load([{name:"scene",gltf:"".concat(Mt,"gltf/tree_scene_009_modified_paths.glb")},{name:"particle_1",texture:"".concat(Mt,"images/particles/particle-5.png")},{name:"particle_2",texture:"".concat(Mt,"images/particles/particle-7.png")},{name:"leaves",fbx:"".concat(Mt,"fbx/tree_V44.fbx")},{name:"scene",texture:"".concat(Mt,"images/scene-bkg-texture.png")}],this.init)}},{key:"initGUI",value:function(){this.guiController={exposure:1,bloomStrength:1.7,bloomThreshold:0,bloomRadius:0,background:664346},Ee.add(this.guiController,"exposure",1,1.3).onChange(this.guiChange),Ee.add(this.guiController,"bloomStrength",0,5).onChange(this.guiChange),Ee.close()}},{key:"events",value:function(){window.addEventListener("WINDOW_RESIZE",this.handleResize,{passive:!0}),window.addEventListener("RAF",this.render,{passive:!0}),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("scroll",this.handleScroll)}},{key:"buildBackground",value:function(){var e=new Ct.PlaneGeometry(4e3,4e3,100),t=new Ct.MeshBasicMaterial({color:new Ct.Color(this.guiController.background)}),r=new Ct.Mesh(e,t);r.position.z=-300,this.scene.add(r),this.backgroundTexture=r}},{key:"buildStats",value:function(){this.stats=new c.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)}},{key:"buildScene",value:function(){this.scene=new Ct.Scene}},{key:"buildRender",value:function(){this.renderer=new Ct.WebGLRenderer({canvas:this.canvas,antialias:!0,alpha:!1,autoClearColor:!1}),this.renderer.toneMapping=Ct.ReinhardToneMapping,this.setSizes()}},{key:"bloom",value:function(){this.renderScene=new Ct.RenderPass(this.scene,this.camera),this.bloomLayer=new Ct.Layers,this.bloomLayer.set(1),this.darkMaterial=new Ct.MeshBasicMaterial({color:"black"}),this.materials={},this.bloomPass=new Ct.UnrealBloomPass(new Ct.Vector2(window.innerWidth,window.innerHeight),1.5,.4,.85),this.bloomPass.threshold=this.guiController.bloomThreshold,this.bloomPass.strength=this.guiController.bloomStrength,this.bloomPass.radius=this.guiController.bloomRadius,this.bloomComposer=new Ct.EffectComposer(this.renderer),this.bloomComposer.renderToScreen=!1,this.bloomComposer.addPass(this.renderScene),this.bloomComposer.addPass(this.bloomPass);var e=new Ct.ShaderPass(new Ct.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.bloomComposer.renderTarget2.texture}},vertexShader:St.a,fragmentShader:xt.a,defines:{}}),"baseTexture");e.needsSwap=!0,this.finalComposer=new Ct.EffectComposer(this.renderer),this.finalComposer.addPass(this.renderScene),this.finalComposer.addPass(e),this.renderer.toneMappingExposure=Math.pow(this.guiController.exposure,4)}},{key:"buildCamera",value:function(){var e=this.width/this.height;this.camera=new Ct.PerspectiveCamera(10,e,1,1e4),this.camera.zoom=.3,this.camera.updateProjectionMatrix(),vt.init(this.camera,this.scene)}},{key:"buildControls",value:function(){this.controls=new Ct.OrbitControls(this.camera,this.renderer.domElement)}},{key:"moveBackground",value:function(){this.backgroundTexture.lookAt(this.camera.parent.position);var e=new Ct.Vector3;this.camera.getWorldDirection(e);var t=this.camera.parent.position.clone().add(e.multiplyScalar(3e3));this.backgroundTexture.position.set(t.x,t.y,t.z),this.backgroundTexture.lookAt(this.camera.parent.position)}},{key:"renderBloom",value:function(e){!0===e?(this.scene.traverse(this.darkenNonBloomed),this.bloomComposer.render(),this.scene.traverse(this.restoreMaterial)):(this.camera.layers.set(1),this.bloomComposer.render(),this.camera.layers.set(0))}},{key:"setSizes",value:function(){var e=window.devicePixelRatio?window.devicePixelRatio:1;e>1&&window.innerWidth>1680?this.renderer.setPixelRatio(1.5):this.renderer.setPixelRatio(e),this.renderer.setSize(this.width,this.height),this.maxHeight=this.scrollContainerEl.offsetHeight-window.innerHeight}},{key:"setUnits",value:function(){this.width=this.canvas.parentNode.offsetWidth,this.height=this.canvas.parentNode.offsetHeight}}])&&At(t.prototype,r),i&&At(t,i),e}();document.querySelectorAll("[data-scene]").forEach((function(e){new Lt(e)}));r(47)}]);
//# sourceMappingURL=bundle.c1b00973e66d895ebc45.js.map